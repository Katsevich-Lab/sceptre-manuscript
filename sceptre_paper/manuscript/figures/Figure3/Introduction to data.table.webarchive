bplist00Ò_WebSubresources_WebMainResource¡Ô	
_WebResourceData_WebResourceMIMEType^WebResourceURL_WebResourceResponseO÷/*
 *  /MathJax.js
 *
 *  Copyright (c) 2009-2017 The MathJax Consortium
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

if(document.getElementById&&document.childNodes&&document.createElement){if(!(window.MathJax&&MathJax.Hub)){if(window.MathJax){window.MathJax={AuthorConfig:window.MathJax}}else{window.MathJax={}}MathJax.isPacked=true;MathJax.version="2.7.2";MathJax.fileversion="2.7.2";MathJax.cdnVersion="2.7.2";MathJax.cdnFileVersions={};(function(d){var b=window[d];if(!b){b=window[d]={}}var e=[];var c=function(f){var g=f.constructor;if(!g){g=function(){}}for(var h in f){if(h!=="constructor"&&f.hasOwnProperty(h)){g[h]=f[h]}}return g};var a=function(){return function(){return arguments.callee.Init.call(this,arguments)}};b.Object=c({constructor:a(),Subclass:function(f,h){var g=a();g.SUPER=this;g.Init=this.Init;g.Subclass=this.Subclass;g.Augment=this.Augment;g.protoFunction=this.protoFunction;g.can=this.can;g.has=this.has;g.isa=this.isa;g.prototype=new this(e);g.prototype.constructor=g;g.Augment(f,h);return g},Init:function(f){var g=this;if(f.length===1&&f[0]===e){return g}if(!(g instanceof f.callee)){g=new f.callee(e)}return g.Init.apply(g,f)||g},Augment:function(f,g){var h;if(f!=null){for(h in f){if(f.hasOwnProperty(h)){this.protoFunction(h,f[h])}}if(f.toString!==this.prototype.toString&&f.toString!=={}.toString){this.protoFunction("toString",f.toString)}}if(g!=null){for(h in g){if(g.hasOwnProperty(h)){this[h]=g[h]}}}return this},protoFunction:function(g,f){this.prototype[g]=f;if(typeof f==="function"){f.SUPER=this.SUPER.prototype}},prototype:{Init:function(){},SUPER:function(f){return f.callee.SUPER},can:function(f){return typeof(this[f])==="function"},has:function(f){return typeof(this[f])!=="undefined"},isa:function(f){return(f instanceof Object)&&(this instanceof f)}},can:function(f){return this.prototype.can.call(this,f)},has:function(f){return this.prototype.has.call(this,f)},isa:function(g){var f=this;while(f){if(f===g){return true}else{f=f.SUPER}}return false},SimpleSUPER:c({constructor:function(f){return this.SimpleSUPER.define(f)},define:function(f){var h={};if(f!=null){for(var g in f){if(f.hasOwnProperty(g)){h[g]=this.wrap(g,f[g])}}if(f.toString!==this.prototype.toString&&f.toString!=={}.toString){h.toString=this.wrap("toString",f.toString)}}return h},wrap:function(i,h){if(typeof(h)!=="function"||!h.toString().match(/\.\s*SUPER\s*\(/)){return h}var g=function(){this.SUPER=g.SUPER[i];try{var f=h.apply(this,arguments)}catch(j){delete this.SUPER;throw j}delete this.SUPER;return f};g.toString=function(){return h.toString.apply(h,arguments)};return g}})});b.Object.isArray=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};b.Object.Array=Array})("MathJax");(function(BASENAME){var BASE=window[BASENAME];if(!BASE){BASE=window[BASENAME]={}}var isArray=BASE.Object.isArray;var CALLBACK=function(data){var cb=function(){return arguments.callee.execute.apply(arguments.callee,arguments)};for(var id in CALLBACK.prototype){if(CALLBACK.prototype.hasOwnProperty(id)){if(typeof(data[id])!=="undefined"){cb[id]=data[id]}else{cb[id]=CALLBACK.prototype[id]}}}cb.toString=CALLBACK.prototype.toString;return cb};CALLBACK.prototype={isCallback:true,hook:function(){},data:[],object:window,execute:function(){if(!this.called||this.autoReset){this.called=!this.autoReset;return this.hook.apply(this.object,this.data.concat([].slice.call(arguments,0)))}},reset:function(){delete this.called},toString:function(){return this.hook.toString.apply(this.hook,arguments)}};var ISCALLBACK=function(f){return(typeof(f)==="function"&&f.isCallback)};var EVAL=function(code){return eval.call(window,code)};var TESTEVAL=function(){EVAL("var __TeSt_VaR__ = 1");if(window.__TeSt_VaR__){try{delete window.__TeSt_VaR__}catch(error){window.__TeSt_VaR__=null}}else{if(window.execScript){EVAL=function(code){BASE.__code=code;code="try {"+BASENAME+".__result = eval("+BASENAME+".__code)} catch(err) {"+BASENAME+".__result = err}";window.execScript(code);var result=BASE.__result;delete BASE.__result;delete BASE.__code;if(result instanceof Error){throw result}return result}}else{EVAL=function(code){BASE.__code=code;code="try {"+BASENAME+".__result = eval("+BASENAME+".__code)} catch(err) {"+BASENAME+".__result = err}";var head=(document.getElementsByTagName("head"))[0];if(!head){head=document.body}var script=document.createElement("script");script.appendChild(document.createTextNode(code));head.appendChild(script);head.removeChild(script);var result=BASE.__result;delete BASE.__result;delete BASE.__code;if(result instanceof Error){throw result}return result}}}TESTEVAL=null};var USING=function(args,i){if(arguments.length>1){if(arguments.length===2&&!(typeof arguments[0]==="function")&&arguments[0] instanceof Object&&typeof arguments[1]==="number"){args=[].slice.call(args,i)}else{args=[].slice.call(arguments,0)}}if(isArray(args)&&args.length===1&&typeof(args[0])==="function"){args=args[0]}if(typeof args==="function"){if(args.execute===CALLBACK.prototype.execute){return args}return CALLBACK({hook:args})}else{if(isArray(args)){if(typeof(args[0])==="string"&&args[1] instanceof Object&&typeof args[1][args[0]]==="function"){return CALLBACK({hook:args[1][args[0]],object:args[1],data:args.slice(2)})}else{if(typeof args[0]==="function"){return CALLBACK({hook:args[0],data:args.slice(1)})}else{if(typeof args[1]==="function"){return CALLBACK({hook:args[1],object:args[0],data:args.slice(2)})}}}}else{if(typeof(args)==="string"){if(TESTEVAL){TESTEVAL()}return CALLBACK({hook:EVAL,data:[args]})}else{if(args instanceof Object){return CALLBACK(args)}else{if(typeof(args)==="undefined"){return CALLBACK({})}}}}}throw Error("Can't make callback from given data")};var DELAY=function(time,callback){callback=USING(callback);callback.timeout=setTimeout(callback,time);return callback};var WAITFOR=function(callback,signal){callback=USING(callback);if(!callback.called){WAITSIGNAL(callback,signal);signal.pending++}};var WAITEXECUTE=function(){var signals=this.signal;delete this.signal;this.execute=this.oldExecute;delete this.oldExecute;var result=this.execute.apply(this,arguments);if(ISCALLBACK(result)&&!result.called){WAITSIGNAL(result,signals)}else{for(var i=0,m=signals.length;i<m;i++){signals[i].pending--;if(signals[i].pending<=0){signals[i].call()}}}};var WAITSIGNAL=function(callback,signals){if(!isArray(signals)){signals=[signals]}if(!callback.signal){callback.oldExecute=callback.execute;callback.execute=WAITEXECUTE;callback.signal=signals}else{if(signals.length===1){callback.signal.push(signals[0])}else{callback.signal=callback.signal.concat(signals)}}};var AFTER=function(callback){callback=USING(callback);callback.pending=0;for(var i=1,m=arguments.length;i<m;i++){if(arguments[i]){WAITFOR(arguments[i],callback)}}if(callback.pending===0){var result=callback();if(ISCALLBACK(result)){callback=result}}return callback};var HOOKS=MathJax.Object.Subclass({Init:function(reset){this.hooks=[];this.remove=[];this.reset=reset;this.running=false},Add:function(hook,priority){if(priority==null){priority=10}if(!ISCALLBACK(hook)){hook=USING(hook)}hook.priority=priority;var i=this.hooks.length;while(i>0&&priority<this.hooks[i-1].priority){i--}this.hooks.splice(i,0,hook);return hook},Remove:function(hook){for(var i=0,m=this.hooks.length;i<m;i++){if(this.hooks[i]===hook){if(this.running){this.remove.push(i)}else{this.hooks.splice(i,1)}return}}},Execute:function(){var callbacks=[{}];this.running=true;for(var i=0,m=this.hooks.length;i<m;i++){if(this.reset){this.hooks[i].reset()}var result=this.hooks[i].apply(window,arguments);if(ISCALLBACK(result)&&!result.called){callbacks.push(result)}}this.running=false;if(this.remove.length){this.RemovePending()}if(callbacks.length===1){return null}if(callbacks.length===2){return callbacks[1]}return AFTER.apply({},callbacks)},RemovePending:function(){this.remove=this.remove.sort();for(var i=this.remove.length-1;i>=0;i--){this.hooks.splice(i,1)}this.remove=[]}});var EXECUTEHOOKS=function(hooks,data,reset){if(!hooks){return null}if(!isArray(hooks)){hooks=[hooks]}if(!isArray(data)){data=(data==null?[]:[data])}var handler=HOOKS(reset);for(var i=0,m=hooks.length;i<m;i++){handler.Add(hooks[i])}return handler.Execute.apply(handler,data)};var QUEUE=BASE.Object.Subclass({Init:function(){this.pending=this.running=0;this.queue=[];this.Push.apply(this,arguments)},Push:function(){var callback;for(var i=0,m=arguments.length;i<m;i++){callback=USING(arguments[i]);if(callback===arguments[i]&&!callback.called){callback=USING(["wait",this,callback])}this.queue.push(callback)}if(!this.running&&!this.pending){this.Process()}return callback},Process:function(queue){while(!this.running&&!this.pending&&this.queue.length){var callback=this.queue[0];queue=this.queue.slice(1);this.queue=[];this.Suspend();var result=callback();this.Resume();if(queue.length){this.queue=queue.concat(this.queue)}if(ISCALLBACK(result)&&!result.called){WAITFOR(result,this)}}},Suspend:function(){this.running++},Resume:function(){if(this.running){this.running--}},call:function(){this.Process.apply(this,arguments)},wait:function(callback){return callback}});var SIGNAL=QUEUE.Subclass({Init:function(name){QUEUE.prototype.Init.call(this);this.name=name;this.posted=[];this.listeners=HOOKS(true);this.posting=false;this.callback=null},Post:function(message,callback,forget){callback=USING(callback);if(this.posting||this.pending){this.Push(["Post",this,message,callback,forget])}else{this.callback=callback;callback.reset();if(!forget){this.posted.push(message)}this.Suspend();this.posting=true;var result=this.listeners.Execute(message);if(ISCALLBACK(result)&&!result.called){WAITFOR(result,this)}this.Resume();this.posting=false;if(!this.pending){this.call()}}return callback},Clear:function(callback){callback=USING(callback);if(this.posting||this.pending){callback=this.Push(["Clear",this,callback])}else{this.posted=[];callback()}return callback},call:function(){this.callback(this);this.Process()},Interest:function(callback,ignorePast,priority){callback=USING(callback);this.listeners.Add(callback,priority);if(!ignorePast){for(var i=0,m=this.posted.length;i<m;i++){callback.reset();var result=callback(this.posted[i]);if(ISCALLBACK(result)&&i===this.posted.length-1){WAITFOR(result,this)}}}return callback},NoInterest:function(callback){this.listeners.Remove(callback)},MessageHook:function(msg,callback,priority){callback=USING(callback);if(!this.hooks){this.hooks={};this.Interest(["ExecuteHooks",this])}if(!this.hooks[msg]){this.hooks[msg]=HOOKS(true)}this.hooks[msg].Add(callback,priority);for(var i=0,m=this.posted.length;i<m;i++){if(this.posted[i]==msg){callback.reset();callback(this.posted[i])}}callback.msg=msg;return callback},ExecuteHooks:function(msg){var type=(isArray(msg)?msg[0]:msg);if(!this.hooks[type]){return null}return this.hooks[type].Execute(msg)},RemoveHook:function(hook){this.hooks[hook.msg].Remove(hook)}},{signals:{},find:function(name){if(!SIGNAL.signals[name]){SIGNAL.signals[name]=new SIGNAL(name)}return SIGNAL.signals[name]}});BASE.Callback=BASE.CallBack=USING;BASE.Callback.Delay=DELAY;BASE.Callback.After=AFTER;BASE.Callback.Queue=QUEUE;BASE.Callback.Signal=SIGNAL.find;BASE.Callback.Hooks=HOOKS;BASE.Callback.ExecuteHooks=EXECUTEHOOKS})("MathJax");(function(e){var a=window[e];if(!a){a=window[e]={}}var d=(navigator.vendor==="Apple Computer, Inc."&&typeof navigator.vendorSub==="undefined");var g=0;var h=function(i){if(document.styleSheets&&document.styleSheets.length>g){g=document.styleSheets.length}if(!i){i=document.head||((document.getElementsByTagName("head"))[0]);if(!i){i=document.body}}return i};var f=[];var c=function(){for(var k=0,j=f.length;k<j;k++){a.Ajax.head.removeChild(f[k])}f=[]};var b={};b[e]="";b.a11y="[MathJax]/extensions/a11y";b.Contrib="https://cdn.mathjax.org/mathjax/contrib";a.Ajax={loaded:{},loading:{},loadHooks:{},timeout:15*1000,styleDelay:1,config:{root:"",path:b},params:{},STATUS:{OK:1,ERROR:-1},fileURL:function(j){var i;while((i=j.match(/^\[([-._a-z0-9]+)\]/i))&&b.hasOwnProperty(i[1])){j=(b[i[1]]||this.config.root)+j.substr(i[1].length+2)}return j},fileName:function(j){var i=this.config.root;if(j.substr(0,i.length)===i){j="["+e+"]"+j.substr(i.length)}do{var k=false;for(var l in b){if(b.hasOwnProperty(l)&&b[l]){if(j.substr(0,b[l].length)===b[l]){j="["+l+"]"+j.substr(b[l].length);k=true;break}}}}while(k);return j},fileRev:function(j){var i=a.cdnFileVersions[j]||a.cdnVersion||"";if(i){i="?V="+i}return i},urlRev:function(i){return this.fileURL(i)+this.fileRev(i)},Require:function(k,n){n=a.Callback(n);var l;if(k instanceof Object){for(var j in k){if(k.hasOwnProperty(j)){l=j.toUpperCase();k=k[j]}}}else{l=k.split(/\./).pop().toUpperCase()}if(this.params.noContrib&&k.substr(0,9)==="[Contrib]"){n(this.STATUS.ERROR)}else{k=this.fileURL(k);if(this.loaded[k]){n(this.loaded[k])}else{var m={};m[l]=k;this.Load(m,n)}}return n},Load:function(k,m){m=a.Callback(m);var l;if(k instanceof Object){for(var j in k){if(k.hasOwnProperty(j)){l=j.toUpperCase();k=k[j]}}}else{l=k.split(/\./).pop().toUpperCase()}k=this.fileURL(k);if(this.loading[k]){this.addHook(k,m)}else{this.head=h(this.head);if(this.loader[l]){this.loader[l].call(this,k,m)}else{throw Error("Can't load files of type "+l)}}return m},LoadHook:function(l,m,k){m=a.Callback(m);if(l instanceof Object){for(var j in l){if(l.hasOwnProperty(j)){l=l[j]}}}l=this.fileURL(l);if(this.loaded[l]){m(this.loaded[l])}else{this.addHook(l,m,k)}return m},addHook:function(j,k,i){if(!this.loadHooks[j]){this.loadHooks[j]=MathJax.Callback.Hooks()}this.loadHooks[j].Add(k,i);k.file=j},removeHook:function(i){if(this.loadHooks[i.file]){this.loadHooks[i.file].Remove(i);if(!this.loadHooks[i.file].hooks.length){delete this.loadHooks[i.file]}}},Preloading:function(){for(var l=0,j=arguments.length;l<j;l++){var k=this.fileURL(arguments[l]);if(!this.loading[k]){this.loading[k]={preloaded:true}}}},loader:{JS:function(k,m){var j=this.fileName(k);var i=document.createElement("script");var l=a.Callback(["loadTimeout",this,k]);this.loading[k]={callback:m,timeout:setTimeout(l,this.timeout),status:this.STATUS.OK,script:i};this.loading[k].message=a.Message.File(j);i.onerror=l;i.type="text/javascript";i.src=k+this.fileRev(j);this.head.appendChild(i)},CSS:function(j,l){var i=this.fileName(j);var k=document.createElement("link");k.rel="stylesheet";k.type="text/css";k.href=j+this.fileRev(i);this.loading[j]={callback:l,message:a.Message.File(i),status:this.STATUS.OK};this.head.appendChild(k);this.timer.create.call(this,[this.timer.file,j],k)}},timer:{create:function(j,i){j=a.Callback(j);if(i.nodeName==="STYLE"&&i.styleSheet&&typeof(i.styleSheet.cssText)!=="undefined"){j(this.STATUS.OK)}else{if(window.chrome&&i.nodeName==="LINK"){j(this.STATUS.OK)}else{if(d){this.timer.start(this,[this.timer.checkSafari2,g++,j],this.styleDelay)}else{this.timer.start(this,[this.timer.checkLength,i,j],this.styleDelay)}}}return j},start:function(j,i,k,l){i=a.Callback(i);i.execute=this.execute;i.time=this.time;i.STATUS=j.STATUS;i.timeout=l||j.timeout;i.delay=i.total=k||0;if(k){setTimeout(i,k)}else{i()}},time:function(i){this.total+=this.delay;this.delay=Math.floor(this.delay*1.05+5);if(this.total>=this.timeout){i(this.STATUS.ERROR);return 1}return 0},file:function(j,i){if(i<0){a.Ajax.loadTimeout(j)}else{a.Ajax.loadComplete(j)}},execute:function(){this.hook.call(this.object,this,this.data[0],this.data[1])},checkSafari2:function(i,j,k){if(i.time(k)){return}if(document.styleSheets.length>j&&document.styleSheets[j].cssRules&&document.styleSheets[j].cssRules.length){k(i.STATUS.OK)}else{setTimeout(i,i.delay)}},checkLength:function(i,l,n){if(i.time(n)){return}var m=0;var j=(l.sheet||l.styleSheet);try{if((j.cssRules||j.rules||[]).length>0){m=1}}catch(k){if(k.message.match(/protected variable|restricted URI/)){m=1}else{if(k.message.match(/Security error/)){m=1}}}if(m){setTimeout(a.Callback([n,i.STATUS.OK]),0)}else{setTimeout(i,i.delay)}}},loadComplete:function(i){i=this.fileURL(i);var j=this.loading[i];if(j&&!j.preloaded){a.Message.Clear(j.message);clearTimeout(j.timeout);if(j.script){if(f.length===0){setTimeout(c,0)}f.push(j.script)}this.loaded[i]=j.status;delete this.loading[i];this.addHook(i,j.callback)}else{if(j){delete this.loading[i]}this.loaded[i]=this.STATUS.OK;j={status:this.STATUS.OK}}if(!this.loadHooks[i]){return null}return this.loadHooks[i].Execute(j.status)},loadTimeout:function(i){if(this.loading[i].timeout){clearTimeout(this.loading[i].timeout)}this.loading[i].status=this.STATUS.ERROR;this.loadError(i);this.loadComplete(i)},loadError:function(i){a.Message.Set(["LoadFailed","File failed to load: %1",i],null,2000);a.Hub.signal.Post(["file load error",i])},Styles:function(k,l){var i=this.StyleString(k);if(i===""){l=a.Callback(l);l()}else{var j=document.createElement("style");j.type="text/css";this.head=h(this.head);this.head.appendChild(j);if(j.styleSheet&&typeof(j.styleSheet.cssText)!=="undefined"){j.styleSheet.cssText=i}else{j.appendChild(document.createTextNode(i))}l=this.timer.create.call(this,l,j)}return l},StyleString:function(n){if(typeof(n)==="string"){return n}var k="",o,m;for(o in n){if(n.hasOwnProperty(o)){if(typeof n[o]==="string"){k+=o+" {"+n[o]+"}\n"}else{if(a.Object.isArray(n[o])){for(var l=0;l<n[o].length;l++){m={};m[o]=n[o][l];k+=this.StyleString(m)}}else{if(o.substr(0,6)==="@media"){k+=o+" {"+this.StyleString(n[o])+"}\n"}else{if(n[o]!=null){m=[];for(var j in n[o]){if(n[o].hasOwnProperty(j)){if(n[o][j]!=null){m[m.length]=j+": "+n[o][j]}}}k+=o+" {"+m.join("; ")+"}\n"}}}}}}return k}}})("MathJax");MathJax.HTML={Element:function(d,f,e){var g=document.createElement(d),h;if(f){if(f.hasOwnProperty("style")){var c=f.style;f.style={};for(h in c){if(c.hasOwnProperty(h)){f.style[h.replace(/-([a-z])/g,this.ucMatch)]=c[h]}}}MathJax.Hub.Insert(g,f);for(h in f){if(h==="role"||h.substr(0,5)==="aria-"){g.setAttribute(h,f[h])}}}if(e){if(!MathJax.Object.isArray(e)){e=[e]}for(var b=0,a=e.length;b<a;b++){if(MathJax.Object.isArray(e[b])){g.appendChild(this.Element(e[b][0],e[b][1],e[b][2]))}else{if(d==="script"){this.setScript(g,e[b])}else{g.appendChild(document.createTextNode(e[b]))}}}}return g},ucMatch:function(a,b){return b.toUpperCase()},addElement:function(b,a,d,c){return b.appendChild(this.Element(a,d,c))},TextNode:function(a){return document.createTextNode(a)},addText:function(a,b){return a.appendChild(this.TextNode(b))},setScript:function(a,b){if(this.setScriptBug){a.text=b}else{while(a.firstChild){a.removeChild(a.firstChild)}this.addText(a,b)}},getScript:function(a){var b=(a.text===""?a.innerHTML:a.text);return b.replace(/^\s+/,"").replace(/\s+$/,"")},Cookie:{prefix:"mjx",expires:365,Set:function(a,e){var d=[];if(e){for(var g in e){if(e.hasOwnProperty(g)){d.push(g+":"+e[g].toString().replace(/&/g,"&&"))}}}var b=this.prefix+"."+a+"="+escape(d.join("&;"));if(this.expires){var f=new Date();f.setDate(f.getDate()+this.expires);b+="; expires="+f.toGMTString()}try{document.cookie=b+"; path=/"}catch(c){}},Get:function(a,d){if(!d){d={}}var g=new RegExp("(?:^|;\\s*)"+this.prefix+"\\."+a+"=([^;]*)(?:;|$)");var f;try{f=g.exec(document.cookie)}catch(c){}if(f&&f[1]!==""){var j=unescape(f[1]).split("&;");for(var e=0,b=j.length;e<b;e++){f=j[e].match(/([^:]+):(.*)/);var h=f[2].replace(/&&/g,"&");if(h==="true"){h=true}else{if(h==="false"){h=false}else{if(h.match(/^-?(\d+(\.\d+)?|\.\d+)$/)){h=parseFloat(h)}}}d[f[1]]=h}}return d}}};MathJax.Localization={locale:"en",directory:"[MathJax]/localization",strings:{ar:{menuTitle:"\u0627\u0644\u0639\u0631\u0628\u064A\u0629"},ast:{menuTitle:"asturianu"},bg:{menuTitle:"\u0431\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438"},bcc:{menuTitle:"\u0628\u0644\u0648\u0686\u06CC"},br:{menuTitle:"brezhoneg"},ca:{menuTitle:"catal\u00E0"},cdo:{menuTitle:"M\u00ECng-d\u0115\u0324ng-ng\u1E73\u0304"},cs:{menuTitle:"\u010De\u0161tina"},da:{menuTitle:"dansk"},de:{menuTitle:"Deutsch"},diq:{menuTitle:"Zazaki"},en:{menuTitle:"English",isLoaded:true},eo:{menuTitle:"Esperanto"},es:{menuTitle:"espa\u00F1ol"},fa:{menuTitle:"\u0641\u0627\u0631\u0633\u06CC"},fi:{menuTitle:"suomi"},fr:{menuTitle:"fran\u00E7ais"},gl:{menuTitle:"galego"},he:{menuTitle:"\u05E2\u05D1\u05E8\u05D9\u05EA"},ia:{menuTitle:"interlingua"},it:{menuTitle:"italiano"},ja:{menuTitle:"\u65E5\u672C\u8A9E"},kn:{menuTitle:"\u0C95\u0CA8\u0CCD\u0CA8\u0CA1"},ko:{menuTitle:"\uD55C\uAD6D\uC5B4"},lb:{menuTitle:"L\u00EBtzebuergesch"},lki:{menuTitle:"\u0644\u06D5\u06A9\u06CC"},lt:{menuTitle:"lietuvi\u0173"},mk:{menuTitle:"\u043C\u0430\u043A\u0435\u0434\u043E\u043D\u0441\u043A\u0438"},nl:{menuTitle:"Nederlands"},oc:{menuTitle:"occitan"},pl:{menuTitle:"polski"},pt:{menuTitle:"portugu\u00EAs"},"pt-br":{menuTitle:"portugu\u00EAs do Brasil"},ru:{menuTitle:"\u0440\u0443\u0441\u0441\u043A\u0438\u0439"},sco:{menuTitle:"Scots"},scn:{menuTitle:"sicilianu"},sk:{menuTitle:"sloven\u010Dina"},sl:{menuTitle:"sloven\u0161\u010Dina"},sv:{menuTitle:"svenska"},th:{menuTitle:"\u0E44\u0E17\u0E22"},tr:{menuTitle:"T\u00FCrk\u00E7e"},uk:{menuTitle:"\u0443\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430"},vi:{menuTitle:"Ti\u1EBFng Vi\u1EC7t"},"zh-hans":{menuTitle:"\u4E2D\u6587\uFF08\u7B80\u4F53\uFF09"},"zh-hant":{menuTitle:"\u6C49\u8BED"}},pattern:/%(\d+|\{\d+\}|\{[a-z]+:\%\d+(?:\|(?:%\{\d+\}|%.|[^\}])*)+\}|.)/g,SPLIT:("axb".split(/(x)/).length===3?function(a,b){return a.split(b)}:function(c,e){var a=[],b,d=0;e.lastIndex=0;while((b=e.exec(c))){a.push(c.substr(d,b.index-d));a.push.apply(a,b.slice(1));d=b.index+b[0].length}a.push(c.substr(d));return a}),_:function(b,a){if(MathJax.Object.isArray(a)){return this.processSnippet(b,a)}return this.processString(this.lookupPhrase(b,a),[].slice.call(arguments,2))},processString:function(l,p,g){var j,e,o=MathJax.Object.isArray;for(j=0,e=p.length;j<e;j++){if(g&&o(p[j])){p[j]=this.processSnippet(g,p[j])}}var f=this.SPLIT(l,this.pattern);for(j=1,e=f.length;j<e;j+=2){var q=f[j].charAt(0);if(q>="0"&&q<="9"){f[j]=p[f[j]-1];if(typeof f[j]==="number"){f[j]=this.number(f[j])}}else{if(q==="{"){q=f[j].substr(1);if(q>="0"&&q<="9"){f[j]=p[f[j].substr(1,f[j].length-2)-1];if(typeof f[j]==="number"){f[j]=this.number(f[j])}}else{var k=f[j].match(/^\{([a-z]+):%(\d+)\|(.*)\}$/);if(k){if(k[1]==="plural"){var d=p[k[2]-1];if(typeof d==="undefined"){f[j]="???"}else{d=this.plural(d)-1;var h=k[3].replace(/(^|[^%])(%%)*%\|/g,"$1$2%\uEFEF").split(/\|/);if(d>=0&&d<h.length){f[j]=this.processString(h[d].replace(/\uEFEF/g,"|"),p,g)}else{f[j]="???"}}}else{f[j]="%"+f[j]}}}}}if(f[j]==null){f[j]="???"}}if(!g){return f.join("")}var a=[],b="";for(j=0;j<e;j++){b+=f[j];j++;if(j<e){if(o(f[j])){a.push(b);a=a.concat(f[j]);b=""}else{b+=f[j]}}}if(b!==""){a.push(b)}return a},processSnippet:function(g,e){var c=[];for(var d=0,b=e.length;d<b;d++){if(MathJax.Object.isArray(e[d])){var f=e[d];if(typeof f[1]==="string"){var h=f[0];if(!MathJax.Object.isArray(h)){h=[g,h]}var a=this.lookupPhrase(h,f[1]);c=c.concat(this.processMarkdown(a,f.slice(2),g))}else{if(MathJax.Object.isArray(f[1])){c=c.concat(this.processSnippet.apply(this,f))}else{if(f.length>=3){c.push([f[0],f[1],this.processSnippet(g,f[2])])}else{c.push(e[d])}}}}else{c.push(e[d])}}return c},markdownPattern:/(%.)|(\*{1,3})((?:%.|.)+?)\2|(`+)((?:%.|.)+?)\4|\[((?:%.|.)+?)\]\(([^\s\)]+)\)/,processMarkdown:function(b,h,d){var j=[],e;var c=b.split(this.markdownPattern);var g=c[0];for(var f=1,a=c.length;f<a;f+=8){if(c[f+1]){e=this.processString(c[f+2],h,d);if(!MathJax.Object.isArray(e)){e=[e]}e=[["b","i","i"][c[f+1].length-1],{},e];if(c[f+1].length===3){e=["b",{},e]}}else{if(c[f+3]){e=this.processString(c[f+4].replace(/^\s/,"").replace(/\s$/,""),h,d);if(!MathJax.Object.isArray(e)){e=[e]}e=["code",{},e]}else{if(c[f+5]){e=this.processString(c[f+5],h,d);if(!MathJax.Object.isArray(e)){e=[e]}e=["a",{href:this.processString(c[f+6],h),target:"_blank"},e]}else{g+=c[f];e=null}}}if(e){j=this.concatString(j,g,h,d);j.push(e);g=""}if(c[f+7]!==""){g+=c[f+7]}}j=this.concatString(j,g,h,d);return j},concatString:function(a,c,b,d){if(c!=""){c=this.processString(c,b,d);if(!MathJax.Object.isArray(c)){c=[c]}a=a.concat(c)}return a},lookupPhrase:function(f,a,d){if(!d){d="_"}if(MathJax.Object.isArray(f)){d=(f[0]||"_");f=(f[1]||"")}var c=this.loadDomain(d);if(c){MathJax.Hub.RestartAfter(c)}var b=this.strings[this.locale];if(b){if(b.domains&&d in b.domains){var e=b.domains[d];if(e.strings&&f in e.strings){a=e.strings[f]}}}return a},loadFile:function(b,d,e){e=MathJax.Callback(e);b=(d.file||b);if(!b.match(/\.js$/)){b+=".js"}if(!b.match(/^([a-z]+:|\[MathJax\])/)){var a=(this.strings[this.locale].directory||this.directory+"/"+this.locale||"[MathJax]/localization/"+this.locale);b=a+"/"+b}var c=MathJax.Ajax.Require(b,function(){d.isLoaded=true;return e()});return(c.called?null:c)},loadDomain:function(c,e){var b,a=this.strings[this.locale];if(a){if(!a.isLoaded){b=this.loadFile(this.locale,a);if(b){return MathJax.Callback.Queue(b,["loadDomain",this,c]).Push(e||{})}}if(a.domains&&c in a.domains){var d=a.domains[c];if(!d.isLoaded){b=this.loadFile(c,d);if(b){return MathJax.Callback.Queue(b).Push(e)}}}}return MathJax.Callback(e)()},Try:function(a){a=MathJax.Callback(a);a.autoReset=true;try{a()}catch(b){if(!b.restart){throw b}MathJax.Callback.After(["Try",this,a],b.restart)}},resetLocale:function(a){if(!a){return}a=a.toLowerCase();while(!this.strings[a]){var c=a.lastIndexOf("-");if(c===-1){return}a=a.substring(0,c)}var b=this.strings[a].remap;this.locale=b?b:a},setLocale:function(a){this.resetLocale(a);if(MathJax.Menu){this.loadDomain("MathMenu")}},addTranslation:function(b,e,c){var d=this.strings[b],a=false;if(!d){d=this.strings[b]={};a=true}if(!d.domains){d.domains={}}if(e){if(!d.domains[e]){d.domains[e]={}}d=d.domains[e]}MathJax.Hub.Insert(d,c);if(a&&MathJax.Menu.menu){MathJax.Menu.CreateLocaleMenu()}},setCSS:function(b){var a=this.strings[this.locale];if(a){if(a.fontFamily){b.style.fontFamily=a.fontFamily}if(a.fontDirection){b.style.direction=a.fontDirection;if(a.fontDirection==="rtl"){b.style.textAlign="right"}}}return b},fontFamily:function(){var a=this.strings[this.locale];return(a?a.fontFamily:null)},fontDirection:function(){var a=this.strings[this.locale];return(a?a.fontDirection:null)},plural:function(b){var a=this.strings[this.locale];if(a&&a.plural){return a.plural(b)}if(b==1){return 1}return 2},number:function(b){var a=this.strings[this.locale];if(a&&a.number){return a.number(b)}return b}};MathJax.Message={ready:false,log:[{}],current:null,textNodeBug:(navigator.vendor==="Apple Computer, Inc."&&typeof navigator.vendorSub==="undefined")||(window.hasOwnProperty&&window.hasOwnProperty("konqueror")),styles:{"#MathJax_Message":{position:"fixed",left:"1px",bottom:"2px","background-color":"#E6E6E6",border:"1px solid #959595",margin:"0px",padding:"2px 8px","z-index":"102",color:"black","font-size":"80%",width:"auto","white-space":"nowrap"},"#MathJax_MSIE_Frame":{position:"absolute",top:0,left:0,width:"0px","z-index":101,border:"0px",margin:"0px",padding:"0px"}},browsers:{MSIE:function(a){MathJax.Message.msieFixedPositionBug=((document.documentMode||0)<7);if(MathJax.Message.msieFixedPositionBug){MathJax.Hub.config.styles["#MathJax_Message"].position="absolute"}MathJax.Message.quirks=(document.compatMode==="BackCompat")},Chrome:function(a){MathJax.Hub.config.styles["#MathJax_Message"].bottom="1.5em";MathJax.Hub.config.styles["#MathJax_Message"].left="1em"}},Init:function(a){if(a){this.ready=true}if(!document.body||!this.ready){return false}if(this.div&&this.div.parentNode==null){this.div=document.getElementById("MathJax_Message");if(this.div){this.text=this.div.firstChild}}if(!this.div){var b=document.body;if(this.msieFixedPositionBug&&window.attachEvent){b=this.frame=this.addDiv(document.body);b.removeAttribute("id");b.style.position="absolute";b.style.border=b.style.margin=b.style.padding="0px";b.style.zIndex="101";b.style.height="0px";b=this.addDiv(b);b.id="MathJax_MSIE_Frame";window.attachEvent("onscroll",this.MoveFrame);window.attachEvent("onresize",this.MoveFrame);this.MoveFrame()}this.div=this.addDiv(b);this.div.style.display="none";this.text=this.div.appendChild(document.createTextNode(""))}return true},addDiv:function(a){var b=document.createElement("div");b.id="MathJax_Message";if(a.firstChild){a.insertBefore(b,a.firstChild)}else{a.appendChild(b)}return b},MoveFrame:function(){var a=(MathJax.Message.quirks?document.body:document.documentElement);var b=MathJax.Message.frame;b.style.left=a.scrollLeft+"px";b.style.top=a.scrollTop+"px";b.style.width=a.clientWidth+"px";b=b.firstChild;b.style.height=a.clientHeight+"px"},localize:function(a){return MathJax.Localization._(a,a)},filterText:function(a,c,b){if(MathJax.Hub.config.messageStyle==="simple"){if(b==="LoadFile"){if(!this.loading){this.loading=this.localize("Loading")+" "}a=this.loading;this.loading+="."}else{if(b==="ProcessMath"){if(!this.processing){this.processing=this.localize("Processing")+" "}a=this.processing;this.processing+="."}else{if(b==="TypesetMath"){if(!this.typesetting){this.typesetting=this.localize("Typesetting")+" "}a=this.typesetting;this.typesetting+="."}}}}return a},clearCounts:function(){delete this.loading;delete this.processing;delete this.typesetting},Set:function(c,e,b){if(e==null){e=this.log.length;this.log[e]={}}var d="";if(MathJax.Object.isArray(c)){d=c[0];if(MathJax.Object.isArray(d)){d=d[1]}try{c=MathJax.Localization._.apply(MathJax.Localization,c)}catch(a){if(!a.restart){throw a}if(!a.restart.called){if(this.log[e].restarted==null){this.log[e].restarted=0}this.log[e].restarted++;delete this.log[e].cleared;MathJax.Callback.After(["Set",this,c,e,b],a.restart);return e}}}if(this.timer){clearTimeout(this.timer);delete this.timer}this.log[e].text=c;this.log[e].filteredText=c=this.filterText(c,e,d);if(typeof(this.log[e].next)==="undefined"){this.log[e].next=this.current;if(this.current!=null){this.log[this.current].prev=e}this.current=e}if(this.current===e&&MathJax.Hub.config.messageStyle!=="none"){if(this.Init()){if(this.textNodeBug){this.div.innerHTML=c}else{this.text.nodeValue=c}this.div.style.display="";if(this.status){window.status="";delete this.status}}else{window.status=c;this.status=true}}if(this.log[e].restarted){if(this.log[e].cleared){b=0}if(--this.log[e].restarted===0){delete this.log[e].cleared}}if(b){setTimeout(MathJax.Callback(["Clear",this,e]),b)}else{if(b==0){this.Clear(e,0)}}return e},Clear:function(b,a){if(this.log[b].prev!=null){this.log[this.log[b].prev].next=this.log[b].next}if(this.log[b].next!=null){this.log[this.log[b].next].prev=this.log[b].prev}if(this.current===b){this.current=this.log[b].next;if(this.text){if(this.div.parentNode==null){this.Init()}if(this.current==null){if(this.timer){clearTimeout(this.timer);delete this.timer}if(a==null){a=600}if(a===0){this.Remove()}else{this.timer=setTimeout(MathJax.Callback(["Remove",this]),a)}}else{if(MathJax.Hub.config.messageStyle!=="none"){if(this.textNodeBug){this.div.innerHTML=this.log[this.current].filteredText}else{this.text.nodeValue=this.log[this.current].filteredText}}}if(this.status){window.status="";delete this.status}}else{if(this.status){window.status=(this.current==null?"":this.log[this.current].text)}}}delete this.log[b].next;delete this.log[b].prev;delete this.log[b].filteredText;if(this.log[b].restarted){this.log[b].cleared=true}},Remove:function(){this.text.nodeValue="";this.div.style.display="none"},File:function(a){return this.Set(["LoadFile","Loading %1",a],null,null)},Log:function(){var b=[];for(var c=1,a=this.log.length;c<a;c++){b[c]=this.log[c].text}return b.join("\n")}};MathJax.Hub={config:{root:"",config:[],styleSheets:[],styles:{".MathJax_Preview":{color:"#888"}},jax:[],extensions:[],preJax:null,postJax:null,displayAlign:"center",displayIndent:"0",preRemoveClass:"MathJax_Preview",showProcessingMessages:true,messageStyle:"normal",delayStartupUntil:"none",skipStartupTypeset:false,elements:[],positionToHash:true,showMathMenu:true,showMathMenuMSIE:true,menuSettings:{zoom:"None",CTRL:false,ALT:false,CMD:false,Shift:false,discoverable:false,zscale:"200%",renderer:null,font:"Auto",context:"MathJax",locale:null,mpContext:false,mpMouse:false,texHints:true,FastPreview:null,assistiveMML:null,inTabOrder:true,semantics:false},errorSettings:{message:["[",["MathProcessingError","Math Processing Error"],"]"],style:{color:"#CC0000","font-style":"italic"}},ignoreMMLattributes:{}},preProcessors:MathJax.Callback.Hooks(true),inputJax:{},outputJax:{order:{}},processSectionDelay:50,processUpdateTime:250,processUpdateDelay:10,signal:MathJax.Callback.Signal("Hub"),Config:function(a){this.Insert(this.config,a);if(this.config.Augment){this.Augment(this.config.Augment)}},CombineConfig:function(c,f){var b=this.config,g,e;c=c.split(/\./);for(var d=0,a=c.length;d<a;d++){g=c[d];if(!b[g]){b[g]={}}e=b;b=b[g]}e[g]=b=this.Insert(f,b);return b},Register:{PreProcessor:function(){return MathJax.Hub.preProcessors.Add.apply(MathJax.Hub.preProcessors,arguments)},MessageHook:function(){return MathJax.Hub.signal.MessageHook.apply(MathJax.Hub.signal,arguments)},StartupHook:function(){return MathJax.Hub.Startup.signal.MessageHook.apply(MathJax.Hub.Startup.signal,arguments)},LoadHook:function(){return MathJax.Ajax.LoadHook.apply(MathJax.Ajax,arguments)}},UnRegister:{PreProcessor:function(a){MathJax.Hub.preProcessors.Remove(a)},MessageHook:function(a){MathJax.Hub.signal.RemoveHook(a)},StartupHook:function(a){MathJax.Hub.Startup.signal.RemoveHook(a)},LoadHook:function(a){MathJax.Ajax.removeHook(a)}},getAllJax:function(e){var c=[],b=this.elementScripts(e);for(var d=0,a=b.length;d<a;d++){if(b[d].MathJax&&b[d].MathJax.elementJax){c.push(b[d].MathJax.elementJax)}}return c},getJaxByType:function(f,e){var c=[],b=this.elementScripts(e);for(var d=0,a=b.length;d<a;d++){if(b[d].MathJax&&b[d].MathJax.elementJax&&b[d].MathJax.elementJax.mimeType===f){c.push(b[d].MathJax.elementJax)}}return c},getJaxByInputType:function(f,e){var c=[],b=this.elementScripts(e);for(var d=0,a=b.length;d<a;d++){if(b[d].MathJax&&b[d].MathJax.elementJax&&b[d].type&&b[d].type.replace(/ *;(.|\s)*/,"")===f){c.push(b[d].MathJax.elementJax)}}return c},getJaxFor:function(a){if(typeof(a)==="string"){a=document.getElementById(a)}if(a&&a.MathJax){return a.MathJax.elementJax}if(this.isMathJaxNode(a)){if(!a.isMathJax){a=a.firstChild}while(a&&!a.jaxID){a=a.parentNode}if(a){return MathJax.OutputJax[a.jaxID].getJaxFromMath(a)}}return null},isJax:function(a){if(typeof(a)==="string"){a=document.getElementById(a)}if(this.isMathJaxNode(a)){return 1}if(a&&(a.tagName||"").toLowerCase()==="script"){if(a.MathJax){return(a.MathJax.state===MathJax.ElementJax.STATE.PROCESSED?1:-1)}if(a.type&&this.inputJax[a.type.replace(/ *;(.|\s)*/,"")]){return -1}}return 0},isMathJaxNode:function(a){return !!a&&(a.isMathJax||(a.className||"")==="MathJax_MathML")},setRenderer:function(d,c){if(!d){return}if(!MathJax.OutputJax[d]){this.config.menuSettings.renderer="";var b="[MathJax]/jax/output/"+d+"/config.js";return MathJax.Ajax.Require(b,["setRenderer",this,d,c])}else{this.config.menuSettings.renderer=d;if(c==null){c="jax/mml"}var a=this.outputJax;if(a[c]&&a[c].length){if(d!==a[c][0].id){a[c].unshift(MathJax.OutputJax[d]);return this.signal.Post(["Renderer Selected",d])}}return null}},Queue:function(){return this.queue.Push.apply(this.queue,arguments)},Typeset:function(c,d){if(!MathJax.isReady){return null}var b=this.elementCallback(c,d);if(b.count){var a=MathJax.Callback.Queue(["PreProcess",this,b.elements],["Process",this,b.elements])}return a.Push(b.callback)},PreProcess:function(e,g){var c=this.elementCallback(e,g);var b=MathJax.Callback.Queue();if(c.count){var f=(c.count===1?[c.elements]:c.elements);b.Push(["Post",this.signal,["Begin PreProcess",c.elements]]);for(var d=0,a=f.length;d<a;d++){if(f[d]){b.Push(["Execute",this.preProcessors,f[d]])}}b.Push(["Post",this.signal,["End PreProcess",c.elements]])}return b.Push(c.callback)},Process:function(a,b){return this.takeAction("Process",a,b)},Update:function(a,b){return this.takeAction("Update",a,b)},Reprocess:function(a,b){return this.takeAction("Reprocess",a,b)},Rerender:function(a,b){return this.takeAction("Rerender",a,b)},takeAction:function(g,d,h){var c=this.elementCallback(d,h);var f=c.elements;var a=MathJax.Callback.Queue(["Clear",this.signal]);var e={scripts:[],start:new Date().getTime(),i:0,j:0,jax:{},jaxIDs:[]};if(c.count){var b=["Delay",MathJax.Callback,this.processSectionDelay];if(!b[2]){b={}}a.Push(["clearCounts",MathJax.Message],["Post",this.signal,["Begin "+g,f]],["Post",this.signal,["Begin Math",f,g]],["prepareScripts",this,g,f,e],["Post",this.signal,["Begin Math Input",f,g]],["processInput",this,e],["Post",this.signal,["End Math Input",f,g]],b,["prepareOutput",this,e,"preProcess"],b,["Post",this.signal,["Begin Math Output",f,g]],["processOutput",this,e],["Post",this.signal,["End Math Output",f,g]],b,["prepareOutput",this,e,"postProcess"],b,["Post",this.signal,["End Math",f,g]],["Post",this.signal,["End "+g,f]],["clearCounts",MathJax.Message])}return a.Push(c.callback)},scriptAction:{Process:function(a){},Update:function(b){var a=b.MathJax.elementJax;if(a&&a.needsUpdate()){a.Remove(true);b.MathJax.state=a.STATE.UPDATE}else{b.MathJax.state=a.STATE.PROCESSED}},Reprocess:function(b){var a=b.MathJax.elementJax;if(a){a.Remove(true);b.MathJax.state=a.STATE.UPDATE}},Rerender:function(b){var a=b.MathJax.elementJax;if(a){a.Remove(true);b.MathJax.state=a.STATE.OUTPUT}}},prepareScripts:function(h,e,g){if(arguments.callee.disabled){return}var b=this.elementScripts(e);var f=MathJax.ElementJax.STATE;for(var d=0,a=b.length;d<a;d++){var c=b[d];if(c.type&&this.inputJax[c.type.replace(/ *;(.|\n)*/,"")]){if(c.MathJax){if(c.MathJax.elementJax&&c.MathJax.elementJax.hover){MathJax.Extension.MathEvents.Hover.ClearHover(c.MathJax.elementJax)}if(c.MathJax.state!==f.PENDING){this.scriptAction[h](c)}}if(!c.MathJax){c.MathJax={state:f.PENDING}}if(c.MathJax.error){delete c.MathJax.error}if(c.MathJax.state!==f.PROCESSED){g.scripts.push(c)}}}},checkScriptSiblings:function(a){if(a.MathJax.checked){return}var b=this.config,f=a.previousSibling;if(f&&f.nodeName==="#text"){var d,e,c=a.nextSibling;if(c&&c.nodeName!=="#text"){c=null}if(b.preJax){if(typeof(b.preJax)==="string"){b.preJax=new RegExp(b.preJax+"$")}d=f.nodeValue.match(b.preJax)}if(b.postJax&&c){if(typeof(b.postJax)==="string"){b.postJax=new RegExp("^"+b.postJax)}e=c.nodeValue.match(b.postJax)}if(d&&(!b.postJax||e)){f.nodeValue=f.nodeValue.replace(b.preJax,(d.length>1?d[1]:""));f=null}if(e&&(!b.preJax||d)){c.nodeValue=c.nodeValue.replace(b.postJax,(e.length>1?e[1]:""))}if(f&&!f.nodeValue.match(/\S/)){f=f.previousSibling}}if(b.preRemoveClass&&f&&f.className===b.preRemoveClass){a.MathJax.preview=f}a.MathJax.checked=1},processInput:function(a){var b,i=MathJax.ElementJax.STATE;var h,e,d=a.scripts.length;try{while(a.i<d){h=a.scripts[a.i];if(!h){a.i++;continue}e=h.previousSibling;if(e&&e.className==="MathJax_Error"){e.parentNode.removeChild(e)}if(!h.parentNode||!h.MathJax||h.MathJax.state===i.PROCESSED){a.i++;continue}if(!h.MathJax.elementJax||h.MathJax.state===i.UPDATE){this.checkScriptSiblings(h);var g=h.type.replace(/ *;(.|\s)*/,"");var j=this.inputJax[g];b=j.Process(h,a);if(typeof b==="function"){if(b.called){continue}this.RestartAfter(b)}b=b.Attach(h,j.id);this.saveScript(b,a,h,i);this.postInputHooks.Execute(b,j.id,h)}else{if(h.MathJax.state===i.OUTPUT){this.saveScript(h.MathJax.elementJax,a,h,i)}}a.i++;var c=new Date().getTime();if(c-a.start>this.processUpdateTime&&a.i<a.scripts.length){a.start=c;this.RestartAfter(MathJax.Callback.Delay(1))}}}catch(f){return this.processError(f,a,"Input")}if(a.scripts.length&&this.config.showProcessingMessages){MathJax.Message.Set(["ProcessMath","Processing math: %1%%",100],0)}a.start=new Date().getTime();a.i=a.j=0;return null},postInputHooks:MathJax.Callback.Hooks(true),saveScript:function(a,d,b,c){if(!this.outputJax[a.mimeType]){b.MathJax.state=c.UPDATE;throw Error("No output jax registered for "+a.mimeType)}a.outputJax=this.outputJax[a.mimeType][0].id;if(!d.jax[a.outputJax]){if(d.jaxIDs.length===0){d.jax[a.outputJax]=d.scripts}else{if(d.jaxIDs.length===1){d.jax[d.jaxIDs[0]]=d.scripts.slice(0,d.i)}d.jax[a.outputJax]=[]}d.jaxIDs.push(a.outputJax)}if(d.jaxIDs.length>1){d.jax[a.outputJax].push(b)}b.MathJax.state=c.OUTPUT},prepareOutput:function(c,f){while(c.j<c.jaxIDs.length){var e=c.jaxIDs[c.j],d=MathJax.OutputJax[e];if(d[f]){try{var a=d[f](c);if(typeof a==="function"){if(a.called){continue}this.RestartAfter(a)}}catch(b){if(!b.restart){MathJax.Message.Set(["PrepError","Error preparing %1 output (%2)",e,f],null,600);MathJax.Hub.lastPrepError=b;c.j++}return MathJax.Callback.After(["prepareOutput",this,c,f],b.restart)}}c.j++}return null},processOutput:function(h){var b,g=MathJax.ElementJax.STATE,d,a=h.scripts.length;try{while(h.i<a){d=h.scripts[h.i];if(!d||!d.parentNode||!d.MathJax||d.MathJax.error){h.i++;continue}var c=d.MathJax.elementJax;if(!c){h.i++;continue}b=MathJax.OutputJax[c.outputJax].Process(d,h);if(b!==false){d.MathJax.state=g.PROCESSED;if(d.MathJax.preview){d.MathJax.preview.innerHTML="";d.MathJax.preview.style.display="none"}this.signal.Post(["New Math",c.inputID])}h.i++;var e=new Date().getTime();if(e-h.start>this.processUpdateTime&&h.i<h.scripts.length){h.start=e;this.RestartAfter(MathJax.Callback.Delay(this.processUpdateDelay))}}}catch(f){return this.processError(f,h,"Output")}if(h.scripts.length&&this.config.showProcessingMessages){MathJax.Message.Set(["TypesetMath","Typesetting math: %1%%",100],0);MathJax.Message.Clear(0)}h.i=h.j=0;return null},processMessage:function(d,b){var a=Math.floor(d.i/(d.scripts.length)*100);var c=(b==="Output"?["TypesetMath","Typesetting math: %1%%"]:["ProcessMath","Processing math: %1%%"]);if(this.config.showProcessingMessages){MathJax.Message.Set(c.concat(a),0)}},processError:function(b,c,a){if(!b.restart){if(!this.config.errorSettings.message){throw b}this.formatError(c.scripts[c.i],b);c.i++}this.processMessage(c,a);return MathJax.Callback.After(["process"+a,this,c],b.restart)},formatError:function(b,f){var h=function(l,k,j,i){return MathJax.Localization._(l,k,j,i)};var e=h("ErrorMessage","Error: %1",f.message)+"\n";if(f.sourceURL||f.fileName){e+="\n"+h("ErrorFile","file: %1",f.sourceURL||f.fileName)}if(f.line||f.lineNumber){e+="\n"+h("ErrorLine","line: %1",f.line||f.lineNumber)}e+="\n\n"+h("ErrorTips","Debugging tips: use %1, inspect %2 in the browser console","'unpacked/MathJax.js'","'MathJax.Hub.lastError'");b.MathJax.error=MathJax.OutputJax.Error.Jax(e,b);if(b.MathJax.elementJax){b.MathJax.error.inputID=b.MathJax.elementJax.inputID}var g=this.config.errorSettings;var a=h(g.messageId,g.message);var c=MathJax.HTML.Element("span",{className:"MathJax_Error",jaxID:"Error",isMathJax:true,id:b.MathJax.error.inputID+"-Frame"},[["span",null,a]]);MathJax.Ajax.Require("[MathJax]/extensions/MathEvents.js",function(){var j=MathJax.Extension.MathEvents.Event,i=MathJax.Hub;c.oncontextmenu=j.Menu;c.onmousedown=j.Mousedown;c.onkeydown=j.Keydown;c.tabIndex=i.getTabOrder(i.getJaxFor(b))});var d=document.getElementById(c.id);if(d){d.parentNode.removeChild(d)}if(b.parentNode){b.parentNode.insertBefore(c,b)}if(b.MathJax.preview){b.MathJax.preview.innerHTML="";b.MathJax.preview.style.display="none"}this.lastError=f;this.signal.Post(["Math Processing Error",b,f])},RestartAfter:function(a){throw this.Insert(Error("restart"),{restart:MathJax.Callback(a)})},elementCallback:function(c,f){if(f==null&&(MathJax.Object.isArray(c)||typeof c==="function")){try{MathJax.Callback(c);f=c;c=null}catch(d){}}if(c==null){c=this.config.elements||[]}if(this.isHTMLCollection(c)){c=this.HTMLCollection2Array(c)}if(!MathJax.Object.isArray(c)){c=[c]}c=[].concat(c);for(var b=0,a=c.length;b<a;b++){if(typeof(c[b])==="string"){c[b]=document.getElementById(c[b])}}if(!document.body){document.body=document.getElementsByTagName("body")[0]}if(c.length==0){c.push(document.body)}if(!f){f={}}return{count:c.length,elements:(c.length===1?c[0]:c),callback:f}},elementScripts:function(e){var b=[];if(MathJax.Object.isArray(e)||this.isHTMLCollection(e)){for(var d=0,a=e.length;d<a;d++){var f=0;for(var c=0;c<d&&!f;c++){f=e[c].contains(e[d])}if(!f){b.push.apply(b,this.elementScripts(e[d]))}}return b}if(typeof(e)==="string"){e=document.getElementById(e)}if(!document.body){document.body=document.getElementsByTagName("body")[0]}if(e==null){e=document.body}if(e.tagName!=null&&e.tagName.toLowerCase()==="script"){return[e]}b=e.getElementsByTagName("script");if(this.msieHTMLCollectionBug){b=this.HTMLCollection2Array(b)}return b},isHTMLCollection:function(a){return("HTMLCollection" in window&&typeof(a)==="object"&&a instanceof HTMLCollection)},HTMLCollection2Array:function(c){if(!this.msieHTMLCollectionBug){return[].slice.call(c)}var b=[];for(var d=0,a=c.length;d<a;d++){b[d]=c[d]}return b},Insert:function(c,a){for(var b in a){if(a.hasOwnProperty(b)){if(typeof a[b]==="object"&&!(MathJax.Object.isArray(a[b]))&&(typeof c[b]==="object"||typeof c[b]==="function")){this.Insert(c[b],a[b])}else{c[b]=a[b]}}}return c},getTabOrder:function(a){return this.config.menuSettings.inTabOrder?0:-1},SplitList:("trim" in String.prototype?function(a){return a.trim().split(/\s+/)}:function(a){return a.replace(/^\s+/,"").replace(/\s+$/,"").split(/\s+/)})};MathJax.Hub.Insert(MathJax.Hub.config.styles,MathJax.Message.styles);MathJax.Hub.Insert(MathJax.Hub.config.styles,{".MathJax_Error":MathJax.Hub.config.errorSettings.style});MathJax.Extension={};MathJax.Hub.Configured=MathJax.Callback({});MathJax.Hub.Startup={script:"",queue:MathJax.Callback.Queue(),signal:MathJax.Callback.Signal("Startup"),params:{},Config:function(){this.queue.Push(["Post",this.signal,"Begin Config"]);if(MathJax.AuthorConfig&&MathJax.AuthorConfig.root){MathJax.Ajax.config.root=MathJax.AuthorConfig.root}if(this.params.locale){MathJax.Localization.resetLocale(this.params.locale);MathJax.Hub.config.menuSettings.locale=this.params.locale}if(this.params.config){var c=this.params.config.split(/,/);for(var b=0,a=c.length;b<a;b++){if(!c[b].match(/\.js$/)){c[b]+=".js"}this.queue.Push(["Require",MathJax.Ajax,this.URL("config",c[b])])}}this.queue.Push(["Config",MathJax.Hub,MathJax.AuthorConfig]);if(this.script.match(/\S/)){this.queue.Push(this.script+";\n1;")}this.queue.Push(["ConfigDelay",this],["ConfigBlocks",this],[function(d){return d.loadArray(MathJax.Hub.config.config,"config",null,true)},this],["Post",this.signal,"End Config"])},ConfigDelay:function(){var a=this.params.delayStartupUntil||MathJax.Hub.config.delayStartupUntil;if(a==="onload"){return this.onload}if(a==="configured"){return MathJax.Hub.Configured}return a},ConfigBlocks:function(){var c=document.getElementsByTagName("script");var b=MathJax.Callback.Queue();for(var d=0,a=c.length;d<a;d++){var e=String(c[d].type).replace(/ /g,"");if(e.match(/^text\/x-mathjax-config(;.*)?$/)&&!e.match(/;executed=true/)){c[d].type+=";executed=true";b.Push(c[d].innerHTML+";\n1;")}}return b.Push(function(){MathJax.Ajax.config.root=MathJax.Hub.config.root})},Cookie:function(){return this.queue.Push(["Post",this.signal,"Begin Cookie"],["Get",MathJax.HTML.Cookie,"menu",MathJax.Hub.config.menuSettings],[function(e){var d=e.menuSettings;if(d.locale){MathJax.Localization.resetLocale(d.locale)}var g=e.menuSettings.renderer,b=e.jax;if(g){var c="output/"+g;b.sort();for(var f=0,a=b.length;f<a;f++){if(b[f].substr(0,7)==="output/"){break}}if(f==a-1){b.pop()}else{while(f<a){if(b[f]===c){b.splice(f,1);break}f++}}b.unshift(c)}if(d.CHTMLpreview!=null){if(d.FastPreview==null){d.FastPreview=d.CHTMLpreview}delete d.CHTMLpreview}if(d.FastPreview&&!MathJax.Extension["fast-preview"]){MathJax.Hub.config.extensions.push("fast-preview.js")}if(e.menuSettings.assistiveMML&&!MathJax.Extension.AssistiveMML){MathJax.Hub.config.extensions.push("AssistiveMML.js")}},MathJax.Hub.config],["Post",this.signal,"End Cookie"])},Styles:function(){return this.queue.Push(["Post",this.signal,"Begin Styles"],["loadArray",this,MathJax.Hub.config.styleSheets,"config"],["Styles",MathJax.Ajax,MathJax.Hub.config.styles],["Post",this.signal,"End Styles"])},Jax:function(){var f=MathJax.Hub.config,c=MathJax.Hub.outputJax;for(var g=0,b=f.jax.length,d=0;g<b;g++){var e=f.jax[g].substr(7);if(f.jax[g].substr(0,7)==="output/"&&c.order[e]==null){c.order[e]=d;d++}}var a=MathJax.Callback.Queue();return a.Push(["Post",this.signal,"Begin Jax"],["loadArray",this,f.jax,"jax","config.js"],["Post",this.signal,"End Jax"])},Extensions:function(){var a=MathJax.Callback.Queue();return a.Push(["Post",this.signal,"Begin Extensions"],["loadArray",this,MathJax.Hub.config.extensions,"extensions"],["Post",this.signal,"End Extensions"])},Message:function(){MathJax.Message.Init(true)},Menu:function(){var b=MathJax.Hub.config.menuSettings,a=MathJax.Hub.outputJax,d;for(var c in a){if(a.hasOwnProperty(c)){if(a[c].length){d=a[c];break}}}if(d&&d.length){if(b.renderer&&b.renderer!==d[0].id){d.unshift(MathJax.OutputJax[b.renderer])}b.renderer=d[0].id}},Hash:function(){if(MathJax.Hub.config.positionToHash&&document.location.hash&&document.body&&document.body.scrollIntoView){var d=document.location.hash.substr(1);var f=document.getElementById(d);if(!f){var c=document.getElementsByTagName("a");for(var e=0,b=c.length;e<b;e++){if(c[e].name===d){f=c[e];break}}}if(f){while(!f.scrollIntoView){f=f.parentNode}f=this.HashCheck(f);if(f&&f.scrollIntoView){setTimeout(function(){f.scrollIntoView(true)},1)}}}},HashCheck:function(b){var a=MathJax.Hub.getJaxFor(b);if(a&&MathJax.OutputJax[a.outputJax].hashCheck){b=MathJax.OutputJax[a.outputJax].hashCheck(b)}return b},MenuZoom:function(){if(MathJax.Hub.config.showMathMenu){if(!MathJax.Extension.MathMenu){setTimeout(function(){MathJax.Callback.Queue(["Require",MathJax.Ajax,"[MathJax]/extensions/MathMenu.js",{}],["loadDomain",MathJax.Localization,"MathMenu"])},1000)}else{setTimeout(MathJax.Callback(["loadDomain",MathJax.Localization,"MathMenu"]),1000)}if(!MathJax.Extension.MathZoom){setTimeout(MathJax.Callback(["Require",MathJax.Ajax,"[MathJax]/extensions/MathZoom.js",{}]),2000)}}},onLoad:function(){var a=this.onload=MathJax.Callback(function(){MathJax.Hub.Startup.signal.Post("onLoad")});if(document.body&&document.readyState){if(MathJax.Hub.Browser.isMSIE){if(document.readyState==="complete"){return[a]}}else{if(document.readyState!=="loading"){return[a]}}}if(window.addEventListener){window.addEventListener("load",a,false);if(!this.params.noDOMContentEvent){window.addEventListener("DOMContentLoaded",a,false)}}else{if(window.attachEvent){window.attachEvent("onload",a)}else{window.onload=a}}return a},Typeset:function(a,b){if(MathJax.Hub.config.skipStartupTypeset){return function(){}}return this.queue.Push(["Post",this.signal,"Begin Typeset"],["Typeset",MathJax.Hub,a,b],["Post",this.signal,"End Typeset"])},URL:function(b,a){if(!a.match(/^([a-z]+:\/\/|\[|\/)/)){a="[MathJax]/"+b+"/"+a}return a},loadArray:function(b,f,c,a){if(b){if(!MathJax.Object.isArray(b)){b=[b]}if(b.length){var h=MathJax.Callback.Queue(),j={},e;for(var g=0,d=b.length;g<d;g++){e=this.URL(f,b[g]);if(c){e+="/"+c}if(a){h.Push(["Require",MathJax.Ajax,e,j])}else{h.Push(MathJax.Ajax.Require(e,j))}}return h.Push({})}}return null}};(function(d){var b=window[d],e="["+d+"]";var c=b.Hub,a=b.Ajax,f=b.Callback;var g=MathJax.Object.Subclass({JAXFILE:"jax.js",require:null,config:{},Init:function(i,h){if(arguments.length===0){return this}return(this.constructor.Subclass(i,h))()},Augment:function(k,j){var i=this.constructor,h={};if(k!=null){for(var l in k){if(k.hasOwnProperty(l)){if(typeof k[l]==="function"){i.protoFunction(l,k[l])}else{h[l]=k[l]}}}if(k.toString!==i.prototype.toString&&k.toString!=={}.toString){i.protoFunction("toString",k.toString)}}c.Insert(i.prototype,h);i.Augment(null,j);return this},Translate:function(h,i){throw Error(this.directory+"/"+this.JAXFILE+" failed to define the Translate() method")},Register:function(h){},Config:function(){this.config=c.CombineConfig(this.id,this.config);if(this.config.Augment){this.Augment(this.config.Augment)}},Startup:function(){},loadComplete:function(i){if(i==="config.js"){return a.loadComplete(this.directory+"/"+i)}else{var h=f.Queue();h.Push(c.Register.StartupHook("End Config",{}),["Post",c.Startup.signal,this.id+" Jax Config"],["Config",this],["Post",c.Startup.signal,this.id+" Jax Require"],[function(j){return MathJax.Hub.Startup.loadArray(j.require,this.directory)},this],[function(j,k){return MathJax.Hub.Startup.loadArray(j.extensions,"extensions/"+k)},this.config||{},this.id],["Post",c.Startup.signal,this.id+" Jax Startup"],["Startup",this],["Post",c.Startup.signal,this.id+" Jax Ready"]);if(this.copyTranslate){h.Push([function(j){j.preProcess=j.preTranslate;j.Process=j.Translate;j.postProcess=j.postTranslate},this.constructor.prototype])}return h.Push(["loadComplete",a,this.directory+"/"+i])}}},{id:"Jax",version:"2.7.2",directory:e+"/jax",extensionDir:e+"/extensions"});b.InputJax=g.Subclass({elementJax:"mml",sourceMenuTitle:["Original","Original Form"],copyTranslate:true,Process:function(l,q){var j=f.Queue(),o;var k=this.elementJax;if(!b.Object.isArray(k)){k=[k]}for(var n=0,h=k.length;n<h;n++){o=b.ElementJax.directory+"/"+k[n]+"/"+this.JAXFILE;if(!this.require){this.require=[]}else{if(!b.Object.isArray(this.require)){this.require=[this.require]}}this.require.push(o);j.Push(a.Require(o))}o=this.directory+"/"+this.JAXFILE;var p=j.Push(a.Require(o));if(!p.called){this.constructor.prototype.Process=function(){if(!p.called){return p}throw Error(o+" failed to load properly")}}k=c.outputJax["jax/"+k[0]];if(k){j.Push(a.Require(k[0].directory+"/"+this.JAXFILE))}return j.Push({})},needsUpdate:function(h){var i=h.SourceElement();return(h.originalText!==b.HTML.getScript(i))},Register:function(h){if(!c.inputJax){c.inputJax={}}c.inputJax[h]=this}},{id:"InputJax",version:"2.7.2",directory:g.directory+"/input",extensionDir:g.extensionDir});b.OutputJax=g.Subclass({copyTranslate:true,preProcess:function(j){var i,h=this.directory+"/"+this.JAXFILE;this.constructor.prototype.preProcess=function(k){if(!i.called){return i}throw Error(h+" failed to load properly")};i=a.Require(h);return i},Register:function(i){var h=c.outputJax;if(!h[i]){h[i]=[]}if(h[i].length&&(this.id===c.config.menuSettings.renderer||(h.order[this.id]||0)<(h.order[h[i][0].id]||0))){h[i].unshift(this)}else{h[i].push(this)}if(!this.require){this.require=[]}else{if(!b.Object.isArray(this.require)){this.require=[this.require]}}this.require.push(b.ElementJax.directory+"/"+(i.split(/\//)[1])+"/"+this.JAXFILE)},Remove:function(h){}},{id:"OutputJax",version:"2.7.2",directory:g.directory+"/output",extensionDir:g.extensionDir,fontDir:e+(b.isPacked?"":"/..")+"/fonts",imageDir:e+(b.isPacked?"":"/..")+"/images"});b.ElementJax=g.Subclass({Init:function(i,h){return this.constructor.Subclass(i,h)},inputJax:null,outputJax:null,inputID:null,originalText:"",mimeType:"",sourceMenuTitle:["MathMLcode","MathML Code"],Text:function(i,j){var h=this.SourceElement();b.HTML.setScript(h,i);h.MathJax.state=this.STATE.UPDATE;return c.Update(h,j)},Reprocess:function(i){var h=this.SourceElement();h.MathJax.state=this.STATE.UPDATE;return c.Reprocess(h,i)},Update:function(h){return this.Rerender(h)},Rerender:function(i){var h=this.SourceElement();h.MathJax.state=this.STATE.OUTPUT;return c.Process(h,i)},Remove:function(h){if(this.hover){this.hover.clear(this)}b.OutputJax[this.outputJax].Remove(this);if(!h){c.signal.Post(["Remove Math",this.inputID]);this.Detach()}},needsUpdate:function(){return b.InputJax[this.inputJax].needsUpdate(this)},SourceElement:function(){return document.getElementById(this.inputID)},Attach:function(i,j){var h=i.MathJax.elementJax;if(i.MathJax.state===this.STATE.UPDATE){h.Clone(this)}else{h=i.MathJax.elementJax=this;if(i.id){this.inputID=i.id}else{i.id=this.inputID=b.ElementJax.GetID();this.newID=1}}h.originalText=b.HTML.getScript(i);h.inputJax=j;if(h.root){h.root.inputID=h.inputID}return h},Detach:function(){var h=this.SourceElement();if(!h){return}try{delete h.MathJax}catch(i){h.MathJax=null}if(this.newID){h.id=""}},Clone:function(h){var i;for(i in this){if(!this.hasOwnProperty(i)){continue}if(typeof(h[i])==="undefined"&&i!=="newID"){delete this[i]}}for(i in h){if(!h.hasOwnProperty(i)){continue}if(typeof(this[i])==="undefined"||(this[i]!==h[i]&&i!=="inputID")){this[i]=h[i]}}}},{id:"ElementJax",version:"2.7.2",directory:g.directory+"/element",extensionDir:g.extensionDir,ID:0,STATE:{PENDING:1,PROCESSED:2,UPDATE:3,OUTPUT:4},GetID:function(){this.ID++;return"MathJax-Element-"+this.ID},Subclass:function(){var h=g.Subclass.apply(this,arguments);h.loadComplete=this.prototype.loadComplete;return h}});b.ElementJax.prototype.STATE=b.ElementJax.STATE;b.OutputJax.Error={id:"Error",version:"2.7.2",config:{},errors:0,ContextMenu:function(){return b.Extension.MathEvents.Event.ContextMenu.apply(b.Extension.MathEvents.Event,arguments)},Mousedown:function(){return b.Extension.MathEvents.Event.AltContextMenu.apply(b.Extension.MathEvents.Event,arguments)},getJaxFromMath:function(h){return(h.nextSibling.MathJax||{}).error},Jax:function(j,i){var h=MathJax.Hub.inputJax[i.type.replace(/ *;(.|\s)*/,"")];this.errors++;return{inputJax:(h||{id:"Error"}).id,outputJax:"Error",inputID:"MathJax-Error-"+this.errors,sourceMenuTitle:["ErrorMessage","Error Message"],sourceMenuFormat:"Error",originalText:MathJax.HTML.getScript(i),errorText:j}}};b.InputJax.Error={id:"Error",version:"2.7.2",config:{},sourceMenuTitle:["Original","Original Form"]}})("MathJax");(function(o){var h=window[o];if(!h){h=window[o]={}}var d=h.Hub;var s=d.Startup;var w=d.config;var g=document.head||(document.getElementsByTagName("head")[0]);if(!g){g=document.childNodes[0]}var b=(document.documentElement||document).getElementsByTagName("script");if(b.length===0&&g.namespaceURI){b=document.getElementsByTagNameNS(g.namespaceURI,"script")}var f=new RegExp("(^|/)"+o+"\\.js(\\?.*)?$");for(var q=b.length-1;q>=0;q--){if((b[q].src||"").match(f)){s.script=b[q].innerHTML;if(RegExp.$2){var t=RegExp.$2.substr(1).split(/\&/);for(var p=0,l=t.length;p<l;p++){var n=t[p].match(/(.*)=(.*)/);if(n){s.params[unescape(n[1])]=unescape(n[2])}else{s.params[t[p]]=true}}}w.root=b[q].src.replace(/(^|\/)[^\/]*(\?.*)?$/,"");h.Ajax.config.root=w.root;h.Ajax.params=s.params;break}}var k=navigator.userAgent;var a={isMac:(navigator.platform.substr(0,3)==="Mac"),isPC:(navigator.platform.substr(0,3)==="Win"),isMSIE:("ActiveXObject" in window&&"clipboardData" in window),isEdge:("MSGestureEvent" in window&&"chrome" in window&&window.chrome.loadTimes==null),isFirefox:(!!k.match(/Gecko\//)&&!k.match(/like Gecko/)),isSafari:(!!k.match(/ (Apple)?WebKit\//)&&!k.match(/ like iPhone /)&&(!window.chrome||window.chrome.app==null)),isChrome:("chrome" in window&&window.chrome.loadTimes!=null),isOpera:("opera" in window&&window.opera.version!=null),isKonqueror:("konqueror" in window&&navigator.vendor=="KDE"),versionAtLeast:function(y){var x=(this.version).split(".");y=(new String(y)).split(".");for(var z=0,j=y.length;z<j;z++){if(x[z]!=y[z]){return parseInt(x[z]||"0")>=parseInt(y[z])}}return true},Select:function(j){var i=j[d.Browser];if(i){return i(d.Browser)}return null}};var e=k.replace(/^Mozilla\/(\d+\.)+\d+ /,"").replace(/[a-z][-a-z0-9._: ]+\/\d+[^ ]*-[^ ]*\.([a-z][a-z])?\d+ /i,"").replace(/Gentoo |Ubuntu\/(\d+\.)*\d+ (\([^)]*\) )?/,"");d.Browser=d.Insert(d.Insert(new String("Unknown"),{version:"0.0"}),a);for(var v in a){if(a.hasOwnProperty(v)){if(a[v]&&v.substr(0,2)==="is"){v=v.slice(2);if(v==="Mac"||v==="PC"){continue}d.Browser=d.Insert(new String(v),a);var r=new RegExp(".*(Version/| Trident/.*; rv:)((?:\\d+\\.)+\\d+)|.*("+v+")"+(v=="MSIE"?" ":"/")+"((?:\\d+\\.)*\\d+)|(?:^|\\(| )([a-z][-a-z0-9._: ]+|(?:Apple)?WebKit)/((?:\\d+\\.)+\\d+)");var u=r.exec(e)||["","","","unknown","0.0"];d.Browser.name=(u[1]!=""?v:(u[3]||u[5]));d.Browser.version=u[2]||u[4]||u[6];break}}}try{d.Browser.Select({Safari:function(j){var i=parseInt((String(j.version).split("."))[0]);if(i>85){j.webkit=j.version}if(i>=538){j.version="8.0"}else{if(i>=537){j.version="7.0"}else{if(i>=536){j.version="6.0"}else{if(i>=534){j.version="5.1"}else{if(i>=533){j.version="5.0"}else{if(i>=526){j.version="4.0"}else{if(i>=525){j.version="3.1"}else{if(i>500){j.version="3.0"}else{if(i>400){j.version="2.0"}else{if(i>85){j.version="1.0"}}}}}}}}}}j.webkit=(navigator.appVersion.match(/WebKit\/(\d+)\./))[1];j.isMobile=(navigator.appVersion.match(/Mobile/i)!=null);j.noContextMenu=j.isMobile},Firefox:function(j){if((j.version==="0.0"||k.match(/Firefox/)==null)&&navigator.product==="Gecko"){var m=k.match(/[\/ ]rv:(\d+\.\d.*?)[\) ]/);if(m){j.version=m[1]}else{var i=(navigator.buildID||navigator.productSub||"0").substr(0,8);if(i>="20111220"){j.version="9.0"}else{if(i>="20111120"){j.version="8.0"}else{if(i>="20110927"){j.version="7.0"}else{if(i>="20110816"){j.version="6.0"}else{if(i>="20110621"){j.version="5.0"}else{if(i>="20110320"){j.version="4.0"}else{if(i>="20100121"){j.version="3.6"}else{if(i>="20090630"){j.version="3.5"}else{if(i>="20080617"){j.version="3.0"}else{if(i>="20061024"){j.version="2.0"}}}}}}}}}}}}j.isMobile=(navigator.appVersion.match(/Android/i)!=null||k.match(/ Fennec\//)!=null||k.match(/Mobile/)!=null)},Chrome:function(i){i.noContextMenu=i.isMobile=!!navigator.userAgent.match(/ Mobile[ \/]/)},Opera:function(i){i.version=opera.version()},Edge:function(i){i.isMobile=!!navigator.userAgent.match(/ Phone/)},MSIE:function(j){j.isMobile=!!navigator.userAgent.match(/ Phone/);j.isIE9=!!(document.documentMode&&(window.performance||window.msPerformance));MathJax.HTML.setScriptBug=!j.isIE9||document.documentMode<9;MathJax.Hub.msieHTMLCollectionBug=(document.documentMode<9);if(document.documentMode<10&&!s.params.NoMathPlayer){try{new ActiveXObject("MathPlayer.Factory.1");j.hasMathPlayer=true}catch(m){}try{if(j.hasMathPlayer){var i=document.createElement("object");i.id="mathplayer";i.classid="clsid:32F66A20-7614-11D4-BD11-00104BD3F987";g.appendChild(i);document.namespaces.add("m","http://www.w3.org/1998/Math/MathML");j.mpNamespace=true;if(document.readyState&&(document.readyState==="loading"||document.readyState==="interactive")){document.write('<?import namespace="m" implementation="#MathPlayer">');j.mpImported=true}}else{document.namespaces.add("mjx_IE_fix","http://www.w3.org/1999/xlink")}}catch(m){}}}})}catch(c){console.error(c.message)}d.Browser.Select(MathJax.Message.browsers);if(h.AuthorConfig&&typeof h.AuthorConfig.AuthorInit==="function"){h.AuthorConfig.AuthorInit()}d.queue=h.Callback.Queue();d.queue.Push(["Post",s.signal,"Begin"],["Config",s],["Cookie",s],["Styles",s],["Message",s],function(){var i=h.Callback.Queue(s.Jax(),s.Extensions());return i.Push({})},["Menu",s],s.onLoad(),function(){MathJax.isReady=true},["Typeset",s],["Hash",s],["MenuZoom",s],["Post",s.signal,"End"])})("MathJax")}};
_application/javascript_Jhttps://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMMLO]bplist00Ô
X$versionY$archiverT$topX$objects  _NSKeyedArchiverÑ	_WebResourceResponse¯'-.4567KLMNOPQRSTUVWXY]^U$nullÝ !"#$%&___nsurlrequest_proto_prop_obj_6___nsurlrequest_proto_prop_obj_3R$2___nsurlrequest_proto_prop_obj_0R$3___nsurlrequest_proto_prop_obj_4V$class___nsurlrequest_proto_prop_obj_1R$4R$0___nsurlrequest_proto_prop_obj_5___nsurlrequest_proto_prop_obj_2R$1	 Ó()$+,WNS.base[NS.relative _Ihttps://mathjax.rstudio.com/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMMLÒ/012Z$classnameX$classesUNSURL¢13XNSObject#AÂ»/Ýg ÈÓ89:BJWNS.keysZNS.objects§;<=>?@A	
§CDEFGHI\Content-TypeX__hhaa__]Last-ModifiedSAgeTDate^Content-LengthTEtag_application/javascript_x

YnBsaXN0MDDWAQIDBAUGBwkLDQ8RU0FnZVRFdGFnXUxhc3QtTW9kaWZpZWRcQ29udGVudC1UeXBlXkNvbnRlbnQtTGVuZ3RoVERhdGWhCFU2NjYyOaEKXxAiIjM1OWI5YzYzY2IzYmE0MzM4NGIyOTk1ZTU2OTlhNjNmIqEMXxAdTW9uLCAyOCBBdWcgMjAxNyAxMjo1NDoyOSBHTVShDl8QFmFwcGxpY2F0aW9uL2phdmFzY3JpcHShEFU2MzI0NKESXxAdVHVlLCAwMSBEZWMgMjAyMCAxNjowNToyMyBHTVQIFRkeLDlITU9VV3x+nqC5u8HDAAAAAAAAAQEAAAAAAAAAEwAAAAAAAAAAAAAAAAAAAOM=_Mon, 28 Aug 2017 12:54:29 GMTU66629_Tue, 01 Dec 2020 16:05:23 GMTU63244_""359b9c63cb3ba43384b2995e5699a63f"Ò/0Z[_NSMutableDictionary£Z\3\NSDictionary_application/javascriptÒ/0_`_NSHTTPURLResponse£ab3_NSHTTPURLResponse]NSURLResponse    $ ) 2 7 I L b d   ¢ Ä æ é07Y\_£¦¨ª¬®°²´¶·¹»½¿ÆÎÚÜÞà,1<EKNW`bdks~ ¢¤¦¨ª¬¹ÂÐÔÙèí¢¨ÈÎóø8=QUi             c              wÕ_WebResourceTextEncodingName_WebResourceFrameNameO ¢ <!DOCTYPE html><html><head>

<meta charset="utf-8">
<meta name="generator" content="pandoc">
<meta http-equiv="X-UA-Compatible" content="IE=EDGE">

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2020-10-17">

<title>Introduction to data.table</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      a.sourceLine { display: inline-block; line-height: 1.25; }
  a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
  a.sourceLine:empty { height: 1.2em; }
  .sourceCode { overflow: visible; }
  code.sourceCode { white-space: pre; position: relative; }
  div.sourceCode { margin: 1em 0; }
  pre.sourceCode { margin: 0; }
  @media screen {
  div.sourceCode { overflow: auto; }
  }
  @media print {
  code.sourceCode { white-space: pre-wrap; }
  a.sourceLine { text-indent: -1em; padding-left: 1em; }
  }
  pre.numberSource a.sourceLine
    { position: relative; left: -4em; }
  pre.numberSource a.sourceLine::before
    { content: attr(title);
      position: relative; left: -1em; text-align: right; vertical-align: baseline;
      border: none; pointer-events: all; display: inline-block;
      -webkit-touch-callout: none; -webkit-user-select: none;
      -khtml-user-select: none; -moz-user-select: none;
      -ms-user-select: none; user-select: none;
      padding: 0 4px; width: 4em;
      color: #aaaaaa;
    }
  pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
  div.sourceCode
    {  }
  @media screen {
  a.sourceLine::before { text-decoration: underline; }
  }
  code span.al { color: #ff0000; font-weight: bold; } /* Alert */
  code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
  code span.at { color: #7d9029; } /* Attribute */
  code span.bn { color: #40a070; } /* BaseN */
  code span.bu { } /* BuiltIn */
  code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
  code span.ch { color: #4070a0; } /* Char */
  code span.cn { color: #880000; } /* Constant */
  code span.co { color: #60a0b0; font-style: italic; } /* Comment */
  code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
  code span.do { color: #ba2121; font-style: italic; } /* Documentation */
  code span.dt { color: #902000; } /* DataType */
  code span.dv { color: #40a070; } /* DecVal */
  code span.er { color: #ff0000; font-weight: bold; } /* Error */
  code span.ex { } /* Extension */
  code span.fl { color: #40a070; } /* Float */
  code span.fu { color: #06287e; } /* Function */
  code span.im { } /* Import */
  code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  code span.kw { color: #007020; font-weight: bold; } /* Keyword */
  code span.op { color: #666666; } /* Operator */
  code span.ot { color: #007020; } /* Other */
  code span.pp { color: #bc7a00; } /* Preprocessor */
  code span.sc { color: #4070a0; } /* SpecialChar */
  code span.ss { color: #bb6688; } /* SpecialString */
  code span.st { color: #4070a0; } /* String */
  code span.va { color: #19177c; } /* Variable */
  code span.vs { color: #4070a0; } /* VerbatimString */
  code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




<script type="text/javascript" src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>

<body><div id="MathJax_Message" style="display: none;"></div>




<h1 class="title toc-ignore">Introduction to data.table</h1>
<h4 class="date">2020-10-17</h4>



<p>This vignette introduces the <code>data.table</code> syntax, its general form, how to <em>subset</em> rows, <em>select and compute</em> on columns, and perform aggregations <em>by group</em>. Familiarity with <code>data.frame</code> data structure from base R is useful, but not essential to follow this vignette.</p>
<hr>
<div id="data-analysis-using-data.table" class="section level2">
<h2>Data analysis using <code>data.table</code></h2>
<p>Data manipulation operations such as <em>subset</em>, <em>group</em>, <em>update</em>, <em>join</em> etc., are all inherently related. Keeping these <em>related operations together</em> allows for:</p>
<ul>
<li><p><em>concise</em> and <em>consistent</em> syntax irrespective of the set of operations you would like to perform to achieve your end goal.</p></li>
<li><p>performing analysis <em>fluidly</em> without the cognitive burden of having to map each operation to a particular function from a potentially huge set of functions available before performing the analysis.</p></li>
<li><p><em>automatically</em> optimising operations internally, and very effectively, by knowing precisely the data required for each operation, leading to very fast and memory efficient code.</p></li>
</ul>
<p>Briefly, if you are interested in reducing <em>programming</em> and <em>compute</em> time tremendously, then this package is for you. The philosophy that <code>data.table</code> adheres to makes this possible. Our goal is to illustrate it through this series of vignettes.</p>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>In this vignette, we will use <a href="https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv">NYC-flights14</a> data obtained by <a href="https://github.com/arunsrinivasan/flights">flights</a> package (available on GitHub only). It contains On-Time flights data from the <a href="https://www.transtats.bts.gov">Bureau of Transporation Statistics</a> for all the flights that departed from New York City airports in 2014 (inspired by <a href="https://github.com/hadley/nycflights13">nycflights13</a>). The data is available only for Jan-Octâ14.</p>
<p>We can use <code>data.table</code>âs fast-and-friendly file reader <code>fread</code> to load <code>flights</code> directly as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">input &lt;-<span class="st"> </span><span class="cf">if</span> (<span class="kw">file.exists</span>(<span class="st">"flights14.csv"</span>)) {</a>
<a class="sourceLine" id="cb1-2" title="2">   <span class="st">"flights14.csv"</span></a>
<a class="sourceLine" id="cb1-3" title="3">} <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="st">"https://raw.githubusercontent.com/Rdatatable/data.table/master/vignettes/flights14.csv"</span></a>
<a class="sourceLine" id="cb1-5" title="5">}</a>
<a class="sourceLine" id="cb1-6" title="6">flights &lt;-<span class="st"> </span><span class="kw">fread</span>(input)</a>
<a class="sourceLine" id="cb1-7" title="7">flights</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#         year month day dep_delay arr_delay carrier origin dest air_time distance hour</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#      1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#      2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#      3: 2014     1   1         2         9      AA    JFK  LAX      351     2475   19</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#      4: 2014     1   1        -8       -26      AA    LGA  PBI      157     1035    7</span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#      5: 2014     1   1         2         1      AA    JFK  LAX      350     2475   13</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#     ---                                                                              </span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co"># 253312: 2014    10  31         1       -30      UA    LGA  IAH      201     1416   14</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co"># 253313: 2014    10  31        -5       -14      UA    EWR  IAH      189     1400    8</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co"># 253314: 2014    10  31        -8        16      MQ    LGA  RDU       83      431   11</span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co"># 253315: 2014    10  31        -4        15      MQ    LGA  DTW       75      502   11</span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co"># 253316: 2014    10  31        -5         1      MQ    LGA  SDF      110      659    8</span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="kw">dim</span>(flights)</a>
<a class="sourceLine" id="cb1-21" title="21"><span class="co"># [1] 253316     11</span></a></code></pre></div>
<p>Aside: <code>fread</code> accepts <code>http</code> and <code>https</code> URLs directly as well as operating system commands such as <code>sed</code> and <code>awk</code> output. See <code>?fread</code> for examples.</p>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this vignette, we will</p>
<ol style="list-style-type: decimal">
<li><p>Start with basics - what is a <code>data.table</code>, its general form, how to <em>subset</em> rows, how to <em>select and compute</em> on columns;</p></li>
<li><p>Then we will look at performing data aggregations by group</p></li>
</ol>
</div>
<div id="basics-1" class="section level2">
<h2>1. Basics</h2>
<div id="what-is-datatable-1a" class="section level3">
<h3>a) What is <code>data.table</code>?</h3>
<p><code>data.table</code> is an R package that provides <strong>an enhanced version</strong> of <code>data.frame</code>s, which are the standard data structure for storing data in <code>base</code> R. In the <a href="#data">Data</a> section above, we already created a <code>data.table</code> using <code>fread()</code>. We can also create one using the <code>data.table()</code> function. Here is an example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">DT =<span class="st"> </span><span class="kw">data.table</span>(</a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="dt">ID =</span> <span class="kw">c</span>(<span class="st">"b"</span>,<span class="st">"b"</span>,<span class="st">"b"</span>,<span class="st">"a"</span>,<span class="st">"a"</span>,<span class="st">"c"</span>),</a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="dt">a =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="dt">b =</span> <span class="dv">7</span><span class="op">:</span><span class="dv">12</span>,</a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="dt">c =</span> <span class="dv">13</span><span class="op">:</span><span class="dv">18</span></a>
<a class="sourceLine" id="cb2-6" title="6">)</a>
<a class="sourceLine" id="cb2-7" title="7">DT</a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#    ID a  b  c</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co"># 1:  b 1  7 13</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co"># 2:  b 2  8 14</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co"># 3:  b 3  9 15</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co"># 4:  a 4 10 16</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co"># 5:  a 5 11 17</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co"># 6:  c 6 12 18</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="kw">class</span>(DT<span class="op">$</span>ID)</a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co"># [1] "character"</span></a></code></pre></div>
<p>You can also convert existing objects to a <code>data.table</code> using <code>setDT()</code> (for <code>data.frame</code>s and <code>list</code>s) and <code>as.data.table()</code> (for other structures); the difference is beyond the scope of this vignette, see <code>?setDT</code> and <code>?as.data.table</code> for more details.</p>
<div id="note-that" class="section level4 bs-callout bs-callout-info">
<h4>Note that:</h4>
<ul>
<li><p>Unlike <code>data.frame</code>s, columns of <code>character</code> type are <em>never</em> converted to <code>factors</code> by default.</p></li>
<li><p>Row numbers are printed with a <code>:</code> in order to visually separate the row number from the first column.</p></li>
<li><p>When the number of rows to print exceeds the global option <code>datatable.print.nrows</code> (default = 100), it automatically prints only the top 5 and bottom 5 rows (as can be seen in the <a href="#data">Data</a> section). If youâve had a lot of experience with <code>data.frame</code>s, you may have found yourself waiting around while larger tables print-and-page, sometimes seemingly endlessly. You can query the default number like so:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">getOption</span>(<span class="st">"datatable.print.nrows"</span>)</a></code></pre></div></li>
<li><p><code>data.table</code> doesnât set or use <em>row names</em>, ever. We will see why in the <em>âKeys and fast binary search based subsetâ</em> vignette.</p></li>
</ul>
</div>
</div>
<div id="enhanced-1b" class="section level3">
<h3>b) General form - in what way is a <code>data.table</code> <em>enhanced</em>?</h3>
<p>In contrast to a <code>data.frame</code>, you can do <em>a lot more</em> than just subsetting rows and selecting columns within the frame of a <code>data.table</code>, i.e., within <code>[ ... ]</code> (NB: we might also refer to writing things inside <code>DT[...]</code> as âquerying <code>DT</code>â, in analogy to SQL). To understand it we will have to first look at the <em>general form</em> of <code>data.table</code> syntax, as shown below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">DT[i, j, by]</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">##   R:                 i                 j        by</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">## SQL:  where | order by   select | update  group by</span></a></code></pre></div>
<p>Users who have an SQL background might perhaps immediately relate to this syntax.</p>
<div id="the-way-to-read-it-out-loud-is" class="section level4 bs-callout bs-callout-info">
<h4>The way to read it (out loud) is:</h4>
<p>Take <code>DT</code>, subset/reorder rows using <code>i</code>, then calculate <code>j</code>, grouped by <code>by</code>.</p>
<p>Letâs begin by looking at <code>i</code> and <code>j</code> first - subsetting rows and operating on columns.</p>
</div>
</div>
<div id="subset-i-1c" class="section level3">
<h3>c) Subset rows in <code>i</code></h3>
<div id="get-all-the-flights-with-jfk-as-the-origin-airport-in-the-month-of-june." class="section level4">
<h4>â Get all the flights with âJFKâ as the origin airport in the month of June.</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">ans &lt;-<span class="st"> </span>flights[origin <span class="op">==</span><span class="st"> "JFK"</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span>6L]</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#    year month day dep_delay arr_delay carrier origin dest air_time distance hour</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co"># 1: 2014     6   1        -9        -5      AA    JFK  LAX      324     2475    8</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co"># 2: 2014     6   1       -10       -13      AA    JFK  LAX      329     2475   12</span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co"># 3: 2014     6   1        18        -1      AA    JFK  LAX      326     2475    7</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co"># 4: 2014     6   1        -6       -16      AA    JFK  LAX      320     2475   10</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="co"># 5: 2014     6   1        -4       -45      AA    JFK  LAX      326     2475   18</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co"># 6: 2014     6   1        -6       -23      AA    JFK  LAX      329     2475   14</span></a></code></pre></div>
</div>
<div id="section" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>Within the frame of a <code>data.table</code>, columns can be referred to <em>as if they are variables</em>, much like in SQL or Stata. Therefore, we simply refer to <code>origin</code> and <code>month</code> as if they are variables. We do not need to add the prefix <code>flights$</code> each time. Nevertheless, using <code>flights$origin</code> and <code>flights$month</code> would work just fine.</p></li>
<li><p>The <em>row indices</em> that satisfy the condition <code>origin == "JFK" &amp; month == 6L</code> are computed, and since there is nothing else left to do, all columns from <code>flights</code> at rows corresponding to those <em>row indices</em> are simply returned as a <code>data.table</code>.</p></li>
<li><p>A comma after the condition in <code>i</code> is not required. But <code>flights[origin == "JFK" &amp; month == 6L, ]</code> would work just fine. In <code>data.frame</code>s, however, the comma is necessary.</p></li>
</ul>
</div>
<div id="subset-rows-integer" class="section level4">
<h4>â Get the first two rows from <code>flights</code>.</h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">ans &lt;-<span class="st"> </span>flights[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a>
<a class="sourceLine" id="cb6-2" title="2">ans</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#    year month day dep_delay arr_delay carrier origin dest air_time distance hour</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co"># 1: 2014     1   1        14        13      AA    JFK  LAX      359     2475    9</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co"># 2: 2014     1   1        -3        13      AA    JFK  LAX      363     2475   11</span></a></code></pre></div>
</div>
<div id="section-1" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li>In this case, there is no condition. The row indices are already provided in <code>i</code>. We therefore return a <code>data.table</code> with all columns from <code>flights</code> at rows for those <em>row indices</em>.</li>
</ul>
</div>
<div id="sort-flights-first-by-column-origin-in-ascending-order-and-then-by-dest-in-descending-order" class="section level4">
<h4>â Sort <code>flights</code> first by column <code>origin</code> in <em>ascending</em> order, and then by <code>dest</code> in <em>descending</em> order:</h4>
<p>We can use the R function <code>order()</code> to accomplish this.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">ans &lt;-<span class="st"> </span>flights[<span class="kw">order</span>(origin, <span class="op">-</span>dest)]</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#    year month day dep_delay arr_delay carrier origin dest air_time distance hour</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co"># 1: 2014     1   5         6        49      EV    EWR  XNA      195     1131    8</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co"># 2: 2014     1   6         7        13      EV    EWR  XNA      190     1131    8</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co"># 3: 2014     1   7        -6       -13      EV    EWR  XNA      179     1131    8</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co"># 4: 2014     1   8        -7       -12      EV    EWR  XNA      184     1131    8</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co"># 5: 2014     1   9        16         7      EV    EWR  XNA      181     1131    8</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co"># 6: 2014     1  13        66        66      EV    EWR  XNA      188     1131    9</span></a></code></pre></div>
</div>
<div id="order-is-internally-optimised" class="section level4 bs-callout bs-callout-info">
<h4><code>order()</code> is internally optimised</h4>
<ul>
<li><p>We can use â-â on a <code>character</code> columns within the frame of a <code>data.table</code> to sort in decreasing order.</p></li>
<li><p>In addition, <code>order(...)</code> within the frame of a <code>data.table</code> uses <code>data.table</code>âs internal fast radix order <code>forder()</code>. This sort provided such a compelling improvement over Râs <code>base::order</code> that the R project adopted the <code>data.table</code> algorithm as its default sort in 2016 for R 3.3.0, see <code>?sort</code> and the <a href="https://cran.r-project.org/doc/manuals/r-release/NEWS.pdf">R Release NEWS</a>.</p></li>
</ul>
<p>We will discuss <code>data.table</code>âs fast order in more detail in the <em><code>data.table</code> internals</em> vignette.</p>
</div>
</div>
<div id="select-j-1d" class="section level3">
<h3>d) Select column(s) in <code>j</code></h3>
<div id="select-arr_delay-column-but-return-it-as-a-vector." class="section level4">
<h4>â Select <code>arr_delay</code> column, but return it as a <em>vector</em>.</h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">ans &lt;-<span class="st"> </span>flights[, arr_delay]</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co"># [1]  13  13   9 -26   1   0</span></a></code></pre></div>
</div>
<div id="section-2" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>Since columns can be referred to as if they are variables within the frame of <code>data.table</code>s, we directly refer to the <em>variable</em> we want to subset. Since we want <em>all the rows</em>, we simply skip <code>i</code>.</p></li>
<li><p>It returns <em>all</em> the rows for the column <code>arr_delay</code>.</p></li>
</ul>
</div>
<div id="select-arr_delay-column-but-return-as-a-data.table-instead." class="section level4">
<h4>â Select <code>arr_delay</code> column, but return as a <code>data.table</code> instead.</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">ans &lt;-<span class="st"> </span>flights[, <span class="kw">list</span>(arr_delay)]</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#    arr_delay</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co"># 1:        13</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="co"># 2:        13</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co"># 3:         9</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co"># 4:       -26</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co"># 5:         1</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co"># 6:         0</span></a></code></pre></div>
</div>
<div id="section-3" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>We wrap the <em>variables</em> (column names) within <code>list()</code>, which ensures that a <code>data.table</code> is returned. In case of a single column name, not wrapping with <code>list()</code> returns a vector instead, as seen in the <a href="#select-j-1d">previous example</a>.</p></li>
<li><p><code>data.table</code> also allows wrapping columns with <code>.()</code> instead of <code>list()</code>. It is an <em>alias</em> to <code>list()</code>; they both mean the same. Feel free to use whichever you prefer; we have noticed most users seem to prefer <code>.()</code> for conciseness, so we will continue to use <code>.()</code> hereafter.</p></li>
</ul>
<p><code>data.table</code>s (and <code>data.frame</code>s) are internally <code>list</code>s as well, with the stipulation that each element has the same length and the <code>list</code> has a <code>class</code> attribute. Allowing <code>j</code> to return a <code>list</code> enables converting and returning <code>data.table</code> very efficiently.</p>
</div>
<div id="tip-1" class="section level4 bs-callout bs-callout-warning">
<h4>Tip:</h4>
<p>As long as <code>j-expression</code> returns a <code>list</code>, each element of the list will be converted to a column in the resulting <code>data.table</code>. This makes <code>j</code> quite powerful, as we will see shortly. It is also very important to understand this for when youâd like to make more complicated queries!!</p>
</div>
<div id="select-both-arr_delay-and-dep_delay-columns." class="section level4">
<h4>â Select both <code>arr_delay</code> and <code>dep_delay</code> columns.</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">ans &lt;-<span class="st"> </span>flights[, .(arr_delay, dep_delay)]</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#    arr_delay dep_delay</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co"># 1:        13        14</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co"># 2:        13        -3</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co"># 3:         9         2</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co"># 4:       -26        -8</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co"># 5:         1         2</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co"># 6:         0         4</span></a>
<a class="sourceLine" id="cb10-10" title="10"></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">## alternatively</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co"># ans &lt;- flights[, list(arr_delay, dep_delay)]</span></a></code></pre></div>
</div>
<div id="section-4" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li>Wrap both columns within <code>.()</code>, or <code>list()</code>. Thatâs it.</li>
</ul>
</div>
<div id="select-both-arr_delay-and-dep_delay-columns-and-rename-them-to-delay_arr-and-delay_dep." class="section level4">
<h4>â Select both <code>arr_delay</code> and <code>dep_delay</code> columns <em>and</em> rename them to <code>delay_arr</code> and <code>delay_dep</code>.</h4>
<p>Since <code>.()</code> is just an alias for <code>list()</code>, we can name columns as we would while creating a <code>list</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">ans &lt;-<span class="st"> </span>flights[, .(<span class="dt">delay_arr =</span> arr_delay, <span class="dt">delay_dep =</span> dep_delay)]</a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">#    delay_arr delay_dep</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co"># 1:        13        14</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co"># 2:        13        -3</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co"># 3:         9         2</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co"># 4:       -26        -8</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co"># 5:         1         2</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co"># 6:         0         4</span></a></code></pre></div>
<p>Thatâs it.</p>
</div>
</div>
<div id="e-compute-or-do-in-j" class="section level3">
<h3>e) Compute or <em>do</em> in <code>j</code></h3>
<div id="how-many-trips-have-had-total-delay-0" class="section level4">
<h4>â How many trips have had total delay &lt; 0?</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">ans &lt;-<span class="st"> </span>flights[, <span class="kw">sum</span>( (arr_delay <span class="op">+</span><span class="st"> </span>dep_delay) <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span> )]</a>
<a class="sourceLine" id="cb12-2" title="2">ans</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co"># [1] 141814</span></a></code></pre></div>
</div>
<div id="whats-happening-here" class="section level4 bs-callout bs-callout-info">
<h4>Whatâs happening here?</h4>
<ul>
<li><code>data.table</code>âs <code>j</code> can handle more than just <em>selecting columns</em> - it can handle <em>expressions</em>, i.e., <em>computing on columns</em>. This shouldnât be surprising, as columns can be referred to as if they are variables. Then we should be able to <em>compute</em> by calling functions on those variables. And thatâs what precisely happens here.</li>
</ul>
</div>
</div>
<div id="f-subset-in-i-and-do-in-j" class="section level3">
<h3>f) Subset in <code>i</code> <em>and</em> do in <code>j</code></h3>
<div id="calculate-the-average-arrival-and-departure-delay-for-all-flights-with-jfk-as-the-origin-airport-in-the-month-of-june." class="section level4">
<h4>â Calculate the average arrival and departure delay for all flights with âJFKâ as the origin airport in the month of June.</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">ans &lt;-<span class="st"> </span>flights[origin <span class="op">==</span><span class="st"> "JFK"</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span>6L,</a>
<a class="sourceLine" id="cb13-2" title="2">               .(<span class="dt">m_arr =</span> <span class="kw">mean</span>(arr_delay), <span class="dt">m_dep =</span> <span class="kw">mean</span>(dep_delay))]</a>
<a class="sourceLine" id="cb13-3" title="3">ans</a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">#       m_arr    m_dep</span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="co"># 1: 5.839349 9.807884</span></a></code></pre></div>
</div>
<div id="section-5" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>We first subset in <code>i</code> to find matching <em>row indices</em> where <code>origin</code> airport equals <code>"JFK"</code>, and <code>month</code> equals <code>6L</code>. We <em>do not</em> subset the <em>entire</em> <code>data.table</code> corresponding to those rows <em>yet</em>.</p></li>
<li><p>Now, we look at <code>j</code> and find that it uses only <em>two columns</em>. And what we have to do is to compute their <code>mean()</code>. Therefore we subset just those columns corresponding to the matching rows, and compute their <code>mean()</code>.</p></li>
</ul>
<p>Because the three main components of the query (<code>i</code>, <code>j</code> and <code>by</code>) are <em>together</em> inside <code>[...]</code>, <code>data.table</code> can see all three and optimise the query altogether <em>before evaluation</em>, not each separately. We are able to therefore avoid the entire subset (i.e., subsetting the columns <em>besides</em> <code>arr_delay</code> and <code>dep_delay</code>), for both speed and memory efficiency.</p>
</div>
<div id="how-many-trips-have-been-made-in-2014-from-jfk-airport-in-the-month-of-june" class="section level4">
<h4>â How many trips have been made in 2014 from âJFKâ airport in the month of June?</h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">ans &lt;-<span class="st"> </span>flights[origin <span class="op">==</span><span class="st"> "JFK"</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span>6L, <span class="kw">length</span>(dest)]</a>
<a class="sourceLine" id="cb14-2" title="2">ans</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co"># [1] 8422</span></a></code></pre></div>
<p>The function <code>length()</code> requires an input argument. We just needed to compute the number of rows in the subset. We could have used any other column as input argument to <code>length()</code> really. This approach is reminiscent of <code>SELECT COUNT(dest) FROM flights WHERE origin = 'JFK' AND month = 6</code> in SQL.</p>
<p>This type of operation occurs quite frequently, especially while grouping (as we will see in the next section), to the point where <code>data.table</code> provides a <em>special symbol</em> <code>.N</code> for it.</p>
</div>
<div id="special-N" class="section level4 bs-callout bs-callout-info">
<h4>Special symbol <code>.N</code>:</h4>
<p><code>.N</code> is a special built-in variable that holds the number of observations <em>in the current group</em>. It is particularly useful when combined with <code>by</code> as weâll see in the next section. In the absence of group by operations, it simply returns the number of rows in the subset.</p>
<p>So we can now accomplish the same task by using <code>.N</code> as follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">ans &lt;-<span class="st"> </span>flights[origin <span class="op">==</span><span class="st"> "JFK"</span> <span class="op">&amp;</span><span class="st"> </span>month <span class="op">==</span><span class="st"> </span>6L, .N]</a>
<a class="sourceLine" id="cb15-2" title="2">ans</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co"># [1] 8422</span></a></code></pre></div>
</div>
<div id="section-6" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>Once again, we subset in <code>i</code> to get the <em>row indices</em> where <code>origin</code> airport equals <em>âJFKâ</em>, and <code>month</code> equals <em>6</em>.</p></li>
<li><p>We see that <code>j</code> uses only <code>.N</code> and no other columns. Therefore the entire subset is not materialised. We simply return the number of rows in the subset (which is just the length of row indices).</p></li>
<li><p>Note that we did not wrap <code>.N</code> with <code>list()</code> or <code>.()</code>. Therefore a vector is returned.</p></li>
</ul>
<p>We could have accomplished the same operation by doing <code>nrow(flights[origin == "JFK" &amp; month == 6L])</code>. However, it would have to subset the entire <code>data.table</code> first corresponding to the <em>row indices</em> in <code>i</code> <em>and then</em> return the rows using <code>nrow()</code>, which is unnecessary and inefficient. We will cover this and other optimisation aspects in detail under the <em><code>data.table</code> design</em> vignette.</p>
</div>
</div>
<div id="refer_j" class="section level3">
<h3>g) Great! But how can I refer to columns by names in <code>j</code> (like in a <code>data.frame</code>)?</h3>
<p>If youâre writing out the column names explicitly, thereâs no difference vis-a-vis <code>data.frame</code> (since v1.9.8).</p>
<div id="select-both-arr_delay-and-dep_delay-columns-the-data.frame-way." class="section level4">
<h4>â Select both <code>arr_delay</code> and <code>dep_delay</code> columns the <code>data.frame</code> way.</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">ans &lt;-<span class="st"> </span>flights[, <span class="kw">c</span>(<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>)]</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#    arr_delay dep_delay</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co"># 1:        13        14</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="co"># 2:        13        -3</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co"># 3:         9         2</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co"># 4:       -26        -8</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="co"># 5:         1         2</span></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co"># 6:         0         4</span></a></code></pre></div>
<p>If youâve stored the desired columns in a character vector, there are two options: Using the <code>..</code> prefix, or using the <code>with</code> argument.</p>
</div>
<div id="select-columns-named-in-a-variable-using-the-..-prefix" class="section level4">
<h4>â Select columns named in a variable using the <code>..</code> prefix</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">select_cols =<span class="st"> </span><span class="kw">c</span>(<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>)</a>
<a class="sourceLine" id="cb17-2" title="2">flights[ , ..select_cols]</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">#         arr_delay dep_delay</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#      1:        13        14</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">#      2:        13        -3</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#      3:         9         2</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#      4:       -26        -8</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">#      5:         1         2</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">#     ---                    </span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="co"># 253312:       -30         1</span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="co"># 253313:       -14        -5</span></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co"># 253314:        16        -8</span></a>
<a class="sourceLine" id="cb17-13" title="13"><span class="co"># 253315:        15        -4</span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="co"># 253316:         1        -5</span></a></code></pre></div>
<p>For those familiar with the Unix terminal, the <code>..</code> prefix should be reminiscent of the âup-one-levelâ command, which is analogous to whatâs happening here â the <code>..</code> signals to <code>data.table</code> to look for the <code>select_cols</code> variable âup-one-levelâ, i.e., in the global environment in this case.</p>
</div>
<div id="select-columns-named-in-a-variable-using-with-false" class="section level4">
<h4>â Select columns named in a variable using <code>with = FALSE</code></h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">flights[ , select_cols, with =<span class="st"> </span><span class="ot">FALSE</span>]</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co">#         arr_delay dep_delay</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">#      1:        13        14</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co">#      2:        13        -3</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="co">#      3:         9         2</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co">#      4:       -26        -8</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#      5:         1         2</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#     ---                    </span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co"># 253312:       -30         1</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co"># 253313:       -14        -5</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co"># 253314:        16        -8</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co"># 253315:        15        -4</span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co"># 253316:         1        -5</span></a></code></pre></div>
<p>The argument is named <code>with</code> after the R function <code>with()</code> because of similar functionality. Suppose you have a <code>data.frame</code> <code>DF</code> and youâd like to subset all rows where <code>x &gt; 1</code>. In <code>base</code> R you can do the following:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">DF =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">## (1) normal way</span></a>
<a class="sourceLine" id="cb19-4" title="4">DF[DF<span class="op">$</span>x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>, ] <span class="co"># data.frame needs that ',' as well</span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="co">#   x y</span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="co"># 4 2 4</span></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co"># 5 2 5</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co"># 6 3 6</span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="co"># 7 3 7</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co"># 8 3 8</span></a>
<a class="sourceLine" id="cb19-11" title="11"></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="co">## (2) using with</span></a>
<a class="sourceLine" id="cb19-13" title="13">DF[<span class="kw">with</span>(DF, x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>), ]</a>
<a class="sourceLine" id="cb19-14" title="14"><span class="co">#   x y</span></a>
<a class="sourceLine" id="cb19-15" title="15"><span class="co"># 4 2 4</span></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="co"># 5 2 5</span></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="co"># 6 3 6</span></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="co"># 7 3 7</span></a>
<a class="sourceLine" id="cb19-19" title="19"><span class="co"># 8 3 8</span></a></code></pre></div>
<ul>
<li><p>Using <code>with()</code> in (2) allows using <code>DF</code>âs column <code>x</code> as if it were a variable.</p>
<p>Hence the argument name <code>with</code> in <code>data.table</code>. Setting <code>with = FALSE</code> disables the ability to refer to columns as if they are variables, thereby restoring the â<code>data.frame</code> modeâ.</p></li>
<li><p>We can also <em>deselect</em> columns using <code>-</code> or <code>!</code>. For example:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co">## not run</span></a>
<a class="sourceLine" id="cb20-2" title="2"></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co"># returns all columns except arr_delay and dep_delay</span></a>
<a class="sourceLine" id="cb20-4" title="4">ans &lt;-<span class="st"> </span>flights[, <span class="op">!</span><span class="kw">c</span>(<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>)]</a>
<a class="sourceLine" id="cb20-5" title="5"><span class="co"># or</span></a>
<a class="sourceLine" id="cb20-6" title="6">ans &lt;-<span class="st"> </span>flights[, <span class="op">-</span><span class="kw">c</span>(<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>)]</a></code></pre></div></li>
<li><p>From <code>v1.9.5+</code>, we can also select by specifying start and end column names, e.g., <code>year:day</code> to select the first three columns.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co">## not run</span></a>
<a class="sourceLine" id="cb21-2" title="2"></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co"># returns year,month and day</span></a>
<a class="sourceLine" id="cb21-4" title="4">ans &lt;-<span class="st"> </span>flights[, year<span class="op">:</span>day]</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co"># returns day, month and year</span></a>
<a class="sourceLine" id="cb21-6" title="6">ans &lt;-<span class="st"> </span>flights[, day<span class="op">:</span>year]</a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co"># returns all columns except year, month and day</span></a>
<a class="sourceLine" id="cb21-8" title="8">ans &lt;-<span class="st"> </span>flights[, <span class="op">-</span>(year<span class="op">:</span>day)]</a>
<a class="sourceLine" id="cb21-9" title="9">ans &lt;-<span class="st"> </span>flights[, <span class="op">!</span>(year<span class="op">:</span>day)]</a></code></pre></div>
<p>This is particularly handy while working interactively.</p></li>
</ul>
<p><code>with = TRUE</code> is the default in <code>data.table</code> because we can do much more by allowing <code>j</code> to handle expressions - especially when combined with <code>by</code>, as weâll see in a moment.</p>
</div>
</div>
</div>
<div id="aggregations" class="section level2">
<h2>2. Aggregations</h2>
<p>Weâve already seen <code>i</code> and <code>j</code> from <code>data.table</code>âs general form in the previous section. In this section, weâll see how they can be combined together with <code>by</code> to perform operations <em>by group</em>. Letâs look at some examples.</p>
<div id="a-grouping-using-by" class="section level3">
<h3>a) Grouping using <code>by</code></h3>
<div id="how-can-we-get-the-number-of-trips-corresponding-to-each-origin-airport" class="section level4">
<h4>â How can we get the number of trips corresponding to each origin airport?</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">ans &lt;-<span class="st"> </span>flights[, .(.N), by =<span class="st"> </span>.(origin)]</a>
<a class="sourceLine" id="cb22-2" title="2">ans</a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">#    origin     N</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co"># 1:    JFK 81483</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="co"># 2:    LGA 84433</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co"># 3:    EWR 87400</span></a>
<a class="sourceLine" id="cb22-7" title="7"></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="co">## or equivalently using a character vector in 'by'</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co"># ans &lt;- flights[, .(.N), by = "origin"]</span></a></code></pre></div>
</div>
<div id="section-7" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>We know <code>.N</code> <a href="#special-N">is a special variable</a> that holds the number of rows in the current group. Grouping by <code>origin</code> obtains the number of rows, <code>.N</code>, for each group.</p></li>
<li><p>By doing <code>head(flights)</code> you can see that the origin airports occur in the order <em>âJFKâ</em>, <em>âLGAâ</em> and <em>âEWRâ</em>. The original order of grouping variables is preserved in the result. <em>This is important to keep in mind!</em></p></li>
<li><p>Since we did not provide a name for the column returned in <code>j</code>, it was named <code>N</code> automatically by recognising the special symbol <code>.N</code>.</p></li>
<li><p><code>by</code> also accepts a character vector of column names. This is particularly useful for coding programmatically, e.g., designing a function with the grouping columns as a (<code>character</code> vector) function argument.</p></li>
<li><p>When thereâs only one column or expression to refer to in <code>j</code> and <code>by</code>, we can drop the <code>.()</code> notation. This is purely for convenience. We could instead do:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">ans &lt;-<span class="st"> </span>flights[, .N, by =<span class="st"> </span>origin]</a>
<a class="sourceLine" id="cb23-2" title="2">ans</a>
<a class="sourceLine" id="cb23-3" title="3"><span class="co">#    origin     N</span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="co"># 1:    JFK 81483</span></a>
<a class="sourceLine" id="cb23-5" title="5"><span class="co"># 2:    LGA 84433</span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="co"># 3:    EWR 87400</span></a></code></pre></div>
<p>Weâll use this convenient form wherever applicable hereafter.</p></li>
</ul>
</div>
<div id="origin-.N" class="section level4">
<h4>â How can we calculate the number of trips for each origin airport for carrier code <code>"AA"</code>?</h4>
<p>The unique carrier code <code>"AA"</code> corresponds to <em>American Airlines Inc.</em></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">ans &lt;-<span class="st"> </span>flights[carrier <span class="op">==</span><span class="st"> "AA"</span>, .N, by =<span class="st"> </span>origin]</a>
<a class="sourceLine" id="cb24-2" title="2">ans</a>
<a class="sourceLine" id="cb24-3" title="3"><span class="co">#    origin     N</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="co"># 1:    JFK 11923</span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="co"># 2:    LGA 11730</span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co"># 3:    EWR  2649</span></a></code></pre></div>
</div>
<div id="section-8" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>We first obtain the row indices for the expression <code>carrier == "AA"</code> from <code>i</code>.</p></li>
<li><p>Using those <em>row indices</em>, we obtain the number of rows while grouped by <code>origin</code>. Once again no columns are actually materialised here, because the <code>j-expression</code> does not require any columns to be actually subsetted and is therefore fast and memory efficient.</p></li>
</ul>
</div>
<div id="origin-dest-.N" class="section level4">
<h4>â How can we get the total number of trips for each <code>origin, dest</code> pair for carrier code <code>"AA"</code>?</h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">ans &lt;-<span class="st"> </span>flights[carrier <span class="op">==</span><span class="st"> "AA"</span>, .N, by =<span class="st"> </span>.(origin, dest)]</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co">#    origin dest    N</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co"># 1:    JFK  LAX 3387</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co"># 2:    LGA  PBI  245</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="co"># 3:    EWR  LAX   62</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co"># 4:    JFK  MIA 1876</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="co"># 5:    JFK  SEA  298</span></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="co"># 6:    EWR  MIA  848</span></a>
<a class="sourceLine" id="cb25-10" title="10"></a>
<a class="sourceLine" id="cb25-11" title="11"><span class="co">## or equivalently using a character vector in 'by'</span></a>
<a class="sourceLine" id="cb25-12" title="12"><span class="co"># ans &lt;- flights[carrier == "AA", .N, by = c("origin", "dest")]</span></a></code></pre></div>
</div>
<div id="section-9" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><code>by</code> accepts multiple columns. We just provide all the columns by which to group by. Note the use of <code>.()</code> again in <code>by</code> â again, this is just shorthand for <code>list()</code>, and <code>list()</code> can be used here as well. Again, weâll stick with <code>.()</code> in this vignette.</li>
</ul>
</div>
<div id="origin-dest-month" class="section level4">
<h4>â How can we get the average arrival and departure delay for each <code>orig,dest</code> pair for each month for carrier code <code>"AA"</code>?</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">ans &lt;-<span class="st"> </span>flights[carrier <span class="op">==</span><span class="st"> "AA"</span>,</a>
<a class="sourceLine" id="cb26-2" title="2">        .(<span class="kw">mean</span>(arr_delay), <span class="kw">mean</span>(dep_delay)),</a>
<a class="sourceLine" id="cb26-3" title="3">        by =<span class="st"> </span>.(origin, dest, month)]</a>
<a class="sourceLine" id="cb26-4" title="4">ans</a>
<a class="sourceLine" id="cb26-5" title="5"><span class="co">#      origin dest month         V1         V2</span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co">#   1:    JFK  LAX     1   6.590361 14.2289157</span></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="co">#   2:    LGA  PBI     1  -7.758621  0.3103448</span></a>
<a class="sourceLine" id="cb26-8" title="8"><span class="co">#   3:    EWR  LAX     1   1.366667  7.5000000</span></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="co">#   4:    JFK  MIA     1  15.720670 18.7430168</span></a>
<a class="sourceLine" id="cb26-10" title="10"><span class="co">#   5:    JFK  SEA     1  14.357143 30.7500000</span></a>
<a class="sourceLine" id="cb26-11" title="11"><span class="co">#  ---                                        </span></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="co"># 196:    LGA  MIA    10  -6.251799 -1.4208633</span></a>
<a class="sourceLine" id="cb26-13" title="13"><span class="co"># 197:    JFK  MIA    10  -1.880184  6.6774194</span></a>
<a class="sourceLine" id="cb26-14" title="14"><span class="co"># 198:    EWR  PHX    10  -3.032258 -4.2903226</span></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="co"># 199:    JFK  MCO    10 -10.048387 -1.6129032</span></a>
<a class="sourceLine" id="cb26-16" title="16"><span class="co"># 200:    JFK  DCA    10  16.483871 15.5161290</span></a></code></pre></div>
</div>
<div id="section-10" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>Since we did not provide column names for the expressions in <code>j</code>, they were automatically generated as <code>V1</code> and <code>V2</code>.</p></li>
<li><p>Once again, note that the input order of grouping columns is preserved in the result.</p></li>
</ul>
<p>Now what if we would like to order the result by those grouping columns <code>origin</code>, <code>dest</code> and <code>month</code>?</p>
</div>
</div>
<div id="b-sorted-by-keyby" class="section level3">
<h3>b) Sorted <code>by</code>: <code>keyby</code></h3>
<p><code>data.table</code> retaining the original order of groups is intentional and by design. There are cases when preserving the original order is essential. But at times we would like to automatically sort by the variables in our grouping.</p>
<div id="so-how-can-we-directly-order-by-all-the-grouping-variables" class="section level4">
<h4>â So how can we directly order by all the grouping variables?</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">ans &lt;-<span class="st"> </span>flights[carrier <span class="op">==</span><span class="st"> "AA"</span>,</a>
<a class="sourceLine" id="cb27-2" title="2">        .(<span class="kw">mean</span>(arr_delay), <span class="kw">mean</span>(dep_delay)),</a>
<a class="sourceLine" id="cb27-3" title="3">        keyby =<span class="st"> </span>.(origin, dest, month)]</a>
<a class="sourceLine" id="cb27-4" title="4">ans</a>
<a class="sourceLine" id="cb27-5" title="5"><span class="co">#      origin dest month         V1         V2</span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co">#   1:    EWR  DFW     1   6.427673 10.0125786</span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="co">#   2:    EWR  DFW     2  10.536765 11.3455882</span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="co">#   3:    EWR  DFW     3  12.865031  8.0797546</span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="co">#   4:    EWR  DFW     4  17.792683 12.9207317</span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="co">#   5:    EWR  DFW     5  18.487805 18.6829268</span></a>
<a class="sourceLine" id="cb27-11" title="11"><span class="co">#  ---                                        </span></a>
<a class="sourceLine" id="cb27-12" title="12"><span class="co"># 196:    LGA  PBI     1  -7.758621  0.3103448</span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="co"># 197:    LGA  PBI     2  -7.865385  2.4038462</span></a>
<a class="sourceLine" id="cb27-14" title="14"><span class="co"># 198:    LGA  PBI     3  -5.754098  3.0327869</span></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="co"># 199:    LGA  PBI     4 -13.966667 -4.7333333</span></a>
<a class="sourceLine" id="cb27-16" title="16"><span class="co"># 200:    LGA  PBI     5 -10.357143 -6.8571429</span></a></code></pre></div>
</div>
<div id="section-11" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li>All we did was to change <code>by</code> to <code>keyby</code>. This automatically orders the result by the grouping variables in increasing order. In fact, due to the internal implementation of <code>by</code> first requiring a sort before recovering the original tableâs order, <code>keyby</code> is typically faster than <code>by</code> because it doesnât require this second step.</li>
</ul>
<p><strong>Keys:</strong> Actually <code>keyby</code> does a little more than <em>just ordering</em>. It also <em>sets a key</em> after ordering by setting an <code>attribute</code> called <code>sorted</code>.</p>
<p>Weâll learn more about <code>keys</code> in the <em>Keys and fast binary search based subset</em> vignette; for now, all you have to know is that you can use <code>keyby</code> to automatically order the result by the columns specified in <code>by</code>.</p>
</div>
</div>
<div id="c-chaining" class="section level3">
<h3>c) Chaining</h3>
<p>Letâs reconsider the task of <a href="#origin-dest-.N">getting the total number of trips for each <code>origin, dest</code> pair for carrier <em>âAAâ</em></a>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">ans &lt;-<span class="st"> </span>flights[carrier <span class="op">==</span><span class="st"> "AA"</span>, .N, by =<span class="st"> </span>.(origin, dest)]</a></code></pre></div>
<div id="how-can-we-order-ans-using-the-columns-origin-in-ascending-order-and-dest-in-descending-order" class="section level4">
<h4>â How can we order <code>ans</code> using the columns <code>origin</code> in ascending order, and <code>dest</code> in descending order?</h4>
<p>We can store the intermediate result in a variable, and then use <code>order(origin, -dest)</code> on that variable. It seems fairly straightforward.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">ans &lt;-<span class="st"> </span>ans[<span class="kw">order</span>(origin, <span class="op">-</span>dest)]</a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb29-3" title="3"><span class="co">#    origin dest    N</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co"># 1:    EWR  PHX  121</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="co"># 2:    EWR  MIA  848</span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="co"># 3:    EWR  LAX   62</span></a>
<a class="sourceLine" id="cb29-7" title="7"><span class="co"># 4:    EWR  DFW 1618</span></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="co"># 5:    JFK  STT  229</span></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="co"># 6:    JFK  SJU  690</span></a></code></pre></div>
</div>
<div id="section-12" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>Recall that we can use <code>-</code> on a <code>character</code> column in <code>order()</code> within the frame of a <code>data.table</code>. This is possible to due <code>data.table</code>âs internal query optimisation.</p></li>
<li><p>Also recall that <code>order(...)</code> with the frame of a <code>data.table</code> is <em>automatically optimised</em> to use <code>data.table</code>âs internal fast radix order <code>forder()</code> for speed.</p></li>
</ul>
<p>But this requires having to assign the intermediate result and then overwriting that result. We can do one better and avoid this intermediate assignment to a temporary variable altogether by <em>chaining</em> expressions.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">ans &lt;-<span class="st"> </span>flights[carrier <span class="op">==</span><span class="st"> "AA"</span>, .N, by =<span class="st"> </span>.(origin, dest)][<span class="kw">order</span>(origin, <span class="op">-</span>dest)]</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="kw">head</span>(ans, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb30-3" title="3"><span class="co">#     origin dest    N</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="co">#  1:    EWR  PHX  121</span></a>
<a class="sourceLine" id="cb30-5" title="5"><span class="co">#  2:    EWR  MIA  848</span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="co">#  3:    EWR  LAX   62</span></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="co">#  4:    EWR  DFW 1618</span></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="co">#  5:    JFK  STT  229</span></a>
<a class="sourceLine" id="cb30-9" title="9"><span class="co">#  6:    JFK  SJU  690</span></a>
<a class="sourceLine" id="cb30-10" title="10"><span class="co">#  7:    JFK  SFO 1312</span></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="co">#  8:    JFK  SEA  298</span></a>
<a class="sourceLine" id="cb30-12" title="12"><span class="co">#  9:    JFK  SAN  299</span></a>
<a class="sourceLine" id="cb30-13" title="13"><span class="co"># 10:    JFK  ORD  432</span></a></code></pre></div>
</div>
<div id="section-13" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>We can tack expressions one after another, <em>forming a chain</em> of operations, i.e., <code>DT[ ... ][ ... ][ ... ]</code>.</p></li>
<li><p>Or you can also chain them vertically:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">DT[ ...</a>
<a class="sourceLine" id="cb31-2" title="2">   ][ ...</a>
<a class="sourceLine" id="cb31-3" title="3">     ][ ...</a>
<a class="sourceLine" id="cb31-4" title="4">       ]</a></code></pre></div></li>
</ul>
</div>
</div>
<div id="d-expressions-in-by" class="section level3">
<h3>d) Expressions in <code>by</code></h3>
<div id="can-by-accept-expressions-as-well-or-does-it-just-take-columns" class="section level4">
<h4>â Can <code>by</code> accept <em>expressions</em> as well or does it just take columns?</h4>
<p>Yes it does. As an example, if we would like to find out how many flights started late but arrived early (or on time), started and arrived late etcâ¦</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">ans &lt;-<span class="st"> </span>flights[, .N, .(dep_delay<span class="op">&gt;</span><span class="dv">0</span>, arr_delay<span class="op">&gt;</span><span class="dv">0</span>)]</a>
<a class="sourceLine" id="cb32-2" title="2">ans</a>
<a class="sourceLine" id="cb32-3" title="3"><span class="co">#    dep_delay arr_delay      N</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="co"># 1:      TRUE      TRUE  72836</span></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="co"># 2:     FALSE      TRUE  34583</span></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="co"># 3:     FALSE     FALSE 119304</span></a>
<a class="sourceLine" id="cb32-7" title="7"><span class="co"># 4:      TRUE     FALSE  26593</span></a></code></pre></div>
</div>
<div id="section-14" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>The last row corresponds to <code>dep_delay &gt; 0 = TRUE</code> and <code>arr_delay &gt; 0 = FALSE</code>. We can see that 26593 flights started late but arrived early (or on time).</p></li>
<li><p>Note that we did not provide any names to <code>by-expression</code>. Therefore, names have been automatically assigned in the result. As with <code>j</code>, you can name these expressions as you would elements of any <code>list</code>, e.g.&nbsp;<code>DT[, .N, .(dep_delayed = dep_delay&gt;0, arr_delayed = arr_delay&gt;0)]</code>.</p></li>
<li><p>You can provide other columns along with expressions, for example: <code>DT[, .N, by = .(a, b&gt;0)]</code>.</p></li>
</ul>
</div>
</div>
<div id="e-multiple-columns-in-j---.sd" class="section level3">
<h3>e) Multiple columns in <code>j</code> - <code>.SD</code></h3>
<div id="do-we-have-to-compute-mean-for-each-column-individually" class="section level4">
<h4>â Do we have to compute <code>mean()</code> for each column individually?</h4>
<p>It is of course not practical to have to type <code>mean(myCol)</code> for every column one by one. What if you had 100 columns to average <code>mean()</code>?</p>
<p>How can we do this efficiently, concisely? To get there, refresh on <a href="#tip-1">this tip</a> - <em>âAs long as the <code>j</code>-expression returns a <code>list</code>, each element of the <code>list</code> will be converted to a column in the resulting <code>data.table</code>â</em>. Suppose we can refer to the <em>data subset for each group</em> as a variable <em>while grouping</em>, then we can loop through all the columns of that variable using the already- or soon-to-be-familiar base function <code>lapply()</code>. No new names to learn specific to <code>data.table</code>.</p>
</div>
<div id="special-SD" class="section level4 bs-callout bs-callout-info">
<h4>Special symbol <code>.SD</code>:</h4>
<p><code>data.table</code> provides a <em>special</em> symbol, called <code>.SD</code>. It stands for <strong>S</strong>ubset of <strong>D</strong>ata. It by itself is a <code>data.table</code> that holds the data for <em>the current group</em> defined using <code>by</code>.</p>
<p>Recall that a <code>data.table</code> is internally a <code>list</code> as well with all its columns of equal length.</p>
<p>Letâs use the <a href="#what-is-datatable-1a"><code>data.table</code> <code>DT</code> from before</a> to get a glimpse of what <code>.SD</code> looks like.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">DT</a>
<a class="sourceLine" id="cb33-2" title="2"><span class="co">#    ID a  b  c</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="co"># 1:  b 1  7 13</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="co"># 2:  b 2  8 14</span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="co"># 3:  b 3  9 15</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="co"># 4:  a 4 10 16</span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="co"># 5:  a 5 11 17</span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="co"># 6:  c 6 12 18</span></a>
<a class="sourceLine" id="cb33-9" title="9"></a>
<a class="sourceLine" id="cb33-10" title="10">DT[, <span class="kw">print</span>(.SD), by =<span class="st"> </span>ID]</a>
<a class="sourceLine" id="cb33-11" title="11"><span class="co">#    a b  c</span></a>
<a class="sourceLine" id="cb33-12" title="12"><span class="co"># 1: 1 7 13</span></a>
<a class="sourceLine" id="cb33-13" title="13"><span class="co"># 2: 2 8 14</span></a>
<a class="sourceLine" id="cb33-14" title="14"><span class="co"># 3: 3 9 15</span></a>
<a class="sourceLine" id="cb33-15" title="15"><span class="co">#    a  b  c</span></a>
<a class="sourceLine" id="cb33-16" title="16"><span class="co"># 1: 4 10 16</span></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="co"># 2: 5 11 17</span></a>
<a class="sourceLine" id="cb33-18" title="18"><span class="co">#    a  b  c</span></a>
<a class="sourceLine" id="cb33-19" title="19"><span class="co"># 1: 6 12 18</span></a>
<a class="sourceLine" id="cb33-20" title="20"><span class="co"># Empty data.table (0 rows and 1 cols): ID</span></a></code></pre></div>
</div>
<div id="section-15" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p><code>.SD</code> contains all the columns <em>except the grouping columns</em> by default.</p></li>
<li><p>It is also generated by preserving the original order - data corresponding to <code>ID = "b"</code>, then <code>ID = "a"</code>, and then <code>ID = "c"</code>.</p></li>
</ul>
<p>To compute on (multiple) columns, we can then simply use the base R function <code>lapply()</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">DT[, <span class="kw">lapply</span>(.SD, mean), by =<span class="st"> </span>ID]</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co">#    ID   a    b    c</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="co"># 1:  b 2.0  8.0 14.0</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="co"># 2:  a 4.5 10.5 16.5</span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="co"># 3:  c 6.0 12.0 18.0</span></a></code></pre></div>
</div>
<div id="section-16" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p><code>.SD</code> holds the rows corresponding to columns <code>a</code>, <code>b</code> and <code>c</code> for that group. We compute the <code>mean()</code> on each of these columns using the already-familiar base function <code>lapply()</code>.</p></li>
<li><p>Each group returns a list of three elements containing the mean value which will become the columns of the resulting <code>data.table</code>.</p></li>
<li><p>Since <code>lapply()</code> returns a <code>list</code>, so there is no need to wrap it with an additional <code>.()</code> (if necessary, refer to <a href="#tip-1">this tip</a>).</p></li>
</ul>
<p>We are almost there. There is one little thing left to address. In our <code>flights</code> <code>data.table</code>, we only wanted to calculate the <code>mean()</code> of two columns <code>arr_delay</code> and <code>dep_delay</code>. But <code>.SD</code> would contain all the columns other than the grouping variables by default.</p>
</div>
<div id="how-can-we-specify-just-the-columns-we-would-like-to-compute-the-mean-on" class="section level4">
<h4>â How can we specify just the columns we would like to compute the <code>mean()</code> on?</h4>
</div>
<div id="sdcols" class="section level4 bs-callout bs-callout-info">
<h4>.SDcols</h4>
<p>Using the argument <code>.SDcols</code>. It accepts either column names or column indices. For example, <code>.SDcols = c("arr_delay", "dep_delay")</code> ensures that <code>.SD</code> contains only these two columns for each group.</p>
<p>Similar to <a href="#refer_j">part g)</a>, you can also provide the columns to remove instead of columns to keep using <code>-</code> or <code>!</code> sign as well as select consecutive columns as <code>colA:colB</code> and deselect consecutive columns as <code>!(colA:colB)</code> or <code>-(colA:colB)</code>.</p>
<p>Now let us try to use <code>.SD</code> along with <code>.SDcols</code> to get the <code>mean()</code> of <code>arr_delay</code> and <code>dep_delay</code> columns grouped by <code>origin</code>, <code>dest</code> and <code>month</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">flights[carrier <span class="op">==</span><span class="st"> "AA"</span>,                       <span class="co">## Only on trips with carrier "AA"</span></a>
<a class="sourceLine" id="cb35-2" title="2">        <span class="kw">lapply</span>(.SD, mean),                     <span class="co">## compute the mean</span></a>
<a class="sourceLine" id="cb35-3" title="3">        by =<span class="st"> </span>.(origin, dest, month),           <span class="co">## for every 'origin,dest,month'</span></a>
<a class="sourceLine" id="cb35-4" title="4">        .SDcols =<span class="st"> </span><span class="kw">c</span>(<span class="st">"arr_delay"</span>, <span class="st">"dep_delay"</span>)] <span class="co">## for just those specified in .SDcols</span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="co">#      origin dest month  arr_delay  dep_delay</span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="co">#   1:    JFK  LAX     1   6.590361 14.2289157</span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="co">#   2:    LGA  PBI     1  -7.758621  0.3103448</span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="co">#   3:    EWR  LAX     1   1.366667  7.5000000</span></a>
<a class="sourceLine" id="cb35-9" title="9"><span class="co">#   4:    JFK  MIA     1  15.720670 18.7430168</span></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="co">#   5:    JFK  SEA     1  14.357143 30.7500000</span></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="co">#  ---                                        </span></a>
<a class="sourceLine" id="cb35-12" title="12"><span class="co"># 196:    LGA  MIA    10  -6.251799 -1.4208633</span></a>
<a class="sourceLine" id="cb35-13" title="13"><span class="co"># 197:    JFK  MIA    10  -1.880184  6.6774194</span></a>
<a class="sourceLine" id="cb35-14" title="14"><span class="co"># 198:    EWR  PHX    10  -3.032258 -4.2903226</span></a>
<a class="sourceLine" id="cb35-15" title="15"><span class="co"># 199:    JFK  MCO    10 -10.048387 -1.6129032</span></a>
<a class="sourceLine" id="cb35-16" title="16"><span class="co"># 200:    JFK  DCA    10  16.483871 15.5161290</span></a></code></pre></div>
</div>
</div>
<div id="f-subset-.sd-for-each-group" class="section level3">
<h3>f) Subset <code>.SD</code> for each group:</h3>
<div id="how-can-we-return-the-first-two-rows-for-each-month" class="section level4">
<h4>â How can we return the first two rows for each <code>month</code>?</h4>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">ans &lt;-<span class="st"> </span>flights[, <span class="kw">head</span>(.SD, <span class="dv">2</span>), by =<span class="st"> </span>month]</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="kw">head</span>(ans)</a>
<a class="sourceLine" id="cb36-3" title="3"><span class="co">#    month year day dep_delay arr_delay carrier origin dest air_time distance hour</span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="co"># 1:     1 2014   1        14        13      AA    JFK  LAX      359     2475    9</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="co"># 2:     1 2014   1        -3        13      AA    JFK  LAX      363     2475   11</span></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="co"># 3:     2 2014   1        -1         1      AA    JFK  LAX      358     2475    8</span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="co"># 4:     2 2014   1        -5         3      AA    JFK  LAX      358     2475   11</span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="co"># 5:     3 2014   1       -11        36      AA    JFK  LAX      375     2475    8</span></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="co"># 6:     3 2014   1        -3        14      AA    JFK  LAX      368     2475   11</span></a></code></pre></div>
</div>
<div id="section-17" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p><code>.SD</code> is a <code>data.table</code> that holds all the rows for <em>that group</em>. We simply subset the first two rows as we have seen <a href="#subset-rows-integer">here</a> already.</p></li>
<li><p>For each group, <code>head(.SD, 2)</code> returns the first two rows as a <code>data.table</code>, which is also a <code>list</code>, so we do not have to wrap it with <code>.()</code>.</p></li>
</ul>
</div>
</div>
<div id="g-why-keep-j-so-flexible" class="section level3">
<h3>g) Why keep <code>j</code> so flexible?</h3>
<p>So that we have a consistent syntax and keep using already existing (and familiar) base functions instead of learning new functions. To illustrate, let us use the <code>data.table</code> <code>DT</code> that we created at the very beginning under <a href="#what-is-datatable-1a">What is a data.table?</a> section.</p>
<div id="how-can-we-concatenate-columns-a-and-b-for-each-group-in-id" class="section level4">
<h4>â How can we concatenate columns <code>a</code> and <code>b</code> for each group in <code>ID</code>?</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">DT[, .(<span class="dt">val =</span> <span class="kw">c</span>(a,b)), by =<span class="st"> </span>ID]</a>
<a class="sourceLine" id="cb37-2" title="2"><span class="co">#     ID val</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="co">#  1:  b   1</span></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="co">#  2:  b   2</span></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="co">#  3:  b   3</span></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="co">#  4:  b   7</span></a>
<a class="sourceLine" id="cb37-7" title="7"><span class="co">#  5:  b   8</span></a>
<a class="sourceLine" id="cb37-8" title="8"><span class="co">#  6:  b   9</span></a>
<a class="sourceLine" id="cb37-9" title="9"><span class="co">#  7:  a   4</span></a>
<a class="sourceLine" id="cb37-10" title="10"><span class="co">#  8:  a   5</span></a>
<a class="sourceLine" id="cb37-11" title="11"><span class="co">#  9:  a  10</span></a>
<a class="sourceLine" id="cb37-12" title="12"><span class="co"># 10:  a  11</span></a>
<a class="sourceLine" id="cb37-13" title="13"><span class="co"># 11:  c   6</span></a>
<a class="sourceLine" id="cb37-14" title="14"><span class="co"># 12:  c  12</span></a></code></pre></div>
</div>
<div id="section-18" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li>Thatâs it. There is no special syntax required. All we need to know is the base function <code>c()</code> which concatenates vectors and <a href="#tip-1">the tip from before</a>.</li>
</ul>
</div>
<div id="what-if-we-would-like-to-have-all-the-values-of-column-a-and-b-concatenated-but-returned-as-a-list-column" class="section level4">
<h4>â What if we would like to have all the values of column <code>a</code> and <code>b</code> concatenated, but returned as a list column?</h4>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">DT[, .(<span class="dt">val =</span> <span class="kw">list</span>(<span class="kw">c</span>(a,b))), by =<span class="st"> </span>ID]</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="co">#    ID         val</span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="co"># 1:  b 1,2,3,7,8,9</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="co"># 2:  a  4, 5,10,11</span></a>
<a class="sourceLine" id="cb38-5" title="5"><span class="co"># 3:  c        6,12</span></a></code></pre></div>
</div>
<div id="section-19" class="section level4 bs-callout bs-callout-info">
<h4></h4>
<ul>
<li><p>Here, we first concatenate the values with <code>c(a,b)</code> for each group, and wrap that with <code>list()</code>. So for each group, we return a list of all concatenated values.</p></li>
<li><p>Note those commas are for display only. A list column can contain any object in each cell, and in this example, each cell is itself a vector and some cells contain longer vectors than others.</p></li>
</ul>
<p>Once you start internalising usage in <code>j</code>, you will realise how powerful the syntax can be. A very useful way to understand it is by playing around, with the help of <code>print()</code>.</p>
<p>For example:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co">## (1) look at the difference between</span></a>
<a class="sourceLine" id="cb39-2" title="2">DT[, <span class="kw">print</span>(<span class="kw">c</span>(a,b)), by =<span class="st"> </span>ID]</a>
<a class="sourceLine" id="cb39-3" title="3"><span class="co"># [1] 1 2 3 7 8 9</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co"># [1]  4  5 10 11</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="co"># [1]  6 12</span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="co"># Empty data.table (0 rows and 1 cols): ID</span></a>
<a class="sourceLine" id="cb39-7" title="7"></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="co">## (2) and</span></a>
<a class="sourceLine" id="cb39-9" title="9">DT[, <span class="kw">print</span>(<span class="kw">list</span>(<span class="kw">c</span>(a,b))), by =<span class="st"> </span>ID]</a>
<a class="sourceLine" id="cb39-10" title="10"><span class="co"># [[1]]</span></a>
<a class="sourceLine" id="cb39-11" title="11"><span class="co"># [1] 1 2 3 7 8 9</span></a>
<a class="sourceLine" id="cb39-12" title="12"><span class="co"># </span></a>
<a class="sourceLine" id="cb39-13" title="13"><span class="co"># [[1]]</span></a>
<a class="sourceLine" id="cb39-14" title="14"><span class="co"># [1]  4  5 10 11</span></a>
<a class="sourceLine" id="cb39-15" title="15"><span class="co"># </span></a>
<a class="sourceLine" id="cb39-16" title="16"><span class="co"># [[1]]</span></a>
<a class="sourceLine" id="cb39-17" title="17"><span class="co"># [1]  6 12</span></a>
<a class="sourceLine" id="cb39-18" title="18"><span class="co"># Empty data.table (0 rows and 1 cols): ID</span></a></code></pre></div>
<p>In (1), for each group, a vector is returned, with length = 6,4,2 here. However (2) returns a list of length 1 for each group, with its first element holding vectors of length 6,4,2. Therefore (1) results in a length of <code>6+4+2 = 12</code>, whereas (2) returns <code>1+1+1=3</code>.</p>
</div>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>The general form of <code>data.table</code> syntax is:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">DT[i, j, by]</a></code></pre></div>
<p>We have seen so far that,</p>
<div id="using-i" class="section level4 bs-callout bs-callout-info">
<h4>Using <code>i</code>:</h4>
<ul>
<li><p>We can subset rows similar to a <code>data.frame</code>- except you donât have to use <code>DT$</code> repetitively since columns within the frame of a <code>data.table</code> are seen as if they are <em>variables</em>.</p></li>
<li><p>We can also sort a <code>data.table</code> using <code>order()</code>, which internally uses <code>data.table</code>âs fast order for performance.</p></li>
</ul>
<p>We can do much more in <code>i</code> by keying a <code>data.table</code>, which allows blazing fast subsets and joins. We will see this in the <em>âKeys and fast binary search based subsetsâ</em> and <em>âJoins and rolling joinsâ</em> vignette.</p>
</div>
<div id="using-j" class="section level4 bs-callout bs-callout-info">
<h4>Using <code>j</code>:</h4>
<ol style="list-style-type: decimal">
<li><p>Select columns the <code>data.table</code> way: <code>DT[, .(colA, colB)]</code>.</p></li>
<li><p>Select columns the <code>data.frame</code> way: <code>DT[, c("colA", "colB")]</code>.</p></li>
<li><p>Compute on columns: <code>DT[, .(sum(colA), mean(colB))]</code>.</p></li>
<li><p>Provide names if necessary: <code>DT[, .(sA =sum(colA), mB = mean(colB))]</code>.</p></li>
<li><p>Combine with <code>i</code>: <code>DT[colA &gt; value, sum(colB)]</code>.</p></li>
</ol>
</div>
<div id="using-by" class="section level4 bs-callout bs-callout-info">
<h4>Using <code>by</code>:</h4>
<ul>
<li><p>Using <code>by</code>, we can group by columns by specifying a <em>list of columns</em> or a <em>character vector of column names</em> or even <em>expressions</em>. The flexibility of <code>j</code>, combined with <code>by</code> and <code>i</code> makes for a very powerful syntax.</p></li>
<li><p><code>by</code> can handle multiple columns and also <em>expressions</em>.</p></li>
<li><p>We can <code>keyby</code> grouping columns to automatically sort the grouped result.</p></li>
<li><p>We can use <code>.SD</code> and <code>.SDcols</code> in <code>j</code> to operate on multiple columns using already familiar base functions. Here are some examples:</p>
<ol style="list-style-type: decimal">
<li><p><code>DT[, lapply(.SD, fun), by = ..., .SDcols = ...]</code> - applies <code>fun</code> to all columns specified in <code>.SDcols</code> while grouping by the columns specified in <code>by</code>.</p></li>
<li><p><code>DT[, head(.SD, 2), by = ...]</code> - return the first two rows for each group.</p></li>
<li><p><code>DT[col &gt; val, head(.SD, 1), by = ...]</code> - combine <code>i</code> along with <code>j</code> and <code>by</code>.</p></li>
</ol></li>
</ul>
</div>
<div id="and-remember-the-tip" class="section level4 bs-callout bs-callout-warning">
<h4>And remember the tip:</h4>
<p>As long as <code>j</code> returns a <code>list</code>, each element of the list will become a column in the resulting <code>data.table</code>.</p>
<p>We will see how to <em>add/update/delete</em> columns <em>by reference</em> and how to combine them with <code>i</code> and <code>by</code> in the next vignette.</p>
<hr>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>



</body></html>Ytext/htmlUUTF-8_Qhttps://cran.r-project.org/web/packages/data.table/vignettes/datatable-intro.htmlP            1   3   <   N   d   s     ÷  ÷²  ÷ÿ  þ`  þk  þ  þ   ¦  °  ¶ ¡
                          ¡