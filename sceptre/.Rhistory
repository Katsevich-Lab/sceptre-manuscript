}
}
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400, precomp_base_filename = paste0(offsite_dir, "/data/precomp/gRNA_precomp_"))
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400, precomp_base_filename = paste0(offsite_dir, "/data/precomp/gRNA/gRNA_precomp_"))
gRNA_dictionary
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst")
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst"))
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_"))
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst"))
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
offsite_dir
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_precomp_"))
gene_dictionary
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_precomp_"))
gene_dictionary
library(sceptre)
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_"))
gRNA_dictionary
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst"))
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_precomp_"))
gene_dictionary %>% head()
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_dictionary.fst"))
head(gRNA_gene_pairs)
# 3. gRNA-gene pairs
pairs <- create_precomp_dictionary(ids = gRNA_gene_pairs$gRNA_group, pod_size = 2000, precomp_base_filename = paste0(offsite_dir, "/results/gasperini"))
head(pairs)
rename(pairs, id = gRNA)
rename(pairs, id = "gRNA")
rename(pairs, "id"= "gRNA")
rename(pairs, gRNA = id)
rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id)
rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id, precomp_file_name)
library(sceptre)
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_"))
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst"))
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_precomp_"))
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_dictionary.fst"))
# 3. gRNA-gene pairs
pairs <- create_precomp_dictionary(ids = gRNA_gene_pairs$gRNA_group, pod_size = 2000, precomp_base_filename = paste0(offsite_dir, "/results/gasperini"))
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_"))
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst"))
gRNA_dictionary
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_precomp_"))
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_dictionary.fst"))
# 3. gRNA-gene pairs
pairs <- create_precomp_dictionary(ids = gRNA_gene_pairs$gRNA_group, pod_size = 2000, precomp_base_filename = paste0(offsite_dir, "/results/gasperini"))
rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id, precomp_file_name)
rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id, file_name)
write.fst(pairs, paste0(offsite_dir, "/results/gasperini/results_dictionary.fst"))
library(sceptre)
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
head(gRNA_gene_pairs)
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400, precomp_base_filename = paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_"))
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400)
gRNA_dictionary
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400)
precomp_base_filename <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_")
precomp_base_filename
gRNA_dictionary
gRNA_dictionary <- mutate(gRNA_dictionary, precomp_file = paste0(precomp_base_filename, pod_id))
gRNA_dictionary
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400)
precomp_base_filename <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_")
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
precomp_base_filename <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_")
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400) %>% mutate(precomp_file = factor(paste0(precomp_base_filename, pod_id)))
head(gRNA_dictionary)
head(gRNA_dictionary$precomp_file)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400) %>% mutate(precomp_file = factor(paste0(precomp_base_filename, pod_id, ".fst")))
head(gRNA_dictionary)
gRNA_dictionary$precomp_file[1]
gRNA_dictionary$precomp_file[1000]
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst"))
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
head(genes)
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
precomp_base_filename <- paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_precomp_")
genes
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212, )
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212)
head(gene_dictionary)
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212) %>% mutate(precomp_file = factor(paste0(precomp_base_filename, pod_id, ".fst")))
head(gene_dictionary)
gene_dictionary$precomp_file[1]
write.fst(gene_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_dictionary.fst"))
c
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212) %>% mutate(offset_file = factor(paste0("/data/gasperini/precomp/gene/gene_offsets_", pod_id, ".fst")))
head(gene_dictionary)
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_precomp_dictionary(ids = gRNAs, pod_size = 400) %>% mutate(precomp_file = factor(paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_", pod_id, ".fst")))
head(gRNA_dictionary)
head(gRNA_dictionary$precomp_file)
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
genes
create_precomp_dictionary(ids = genes, pod_size = 212)
genes
create_precomp_dictionary(ids = genes, pod_size = 212)
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_precomp_dictionary(ids = genes, pod_size = 212) %>% mutate(offset_file = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_offsets_", pod_id, ".fst") %>% factor(), dispersion_file = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_dispersion_", pod_id, ".fst"))
gene_dictionary
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_dictionary(ids = genes, pod_size = 212) %>% mutate(offset_file = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_offsets_", pod_id, ".fst") %>% factor(), dispersion_file = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_dispersion_", pod_id, ".fst"))
library(sceptre)
library(sceptre)
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
head(gRNA_gene_pairs)
# 1. gRNA precomputations
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
gRNA_dictionary <- create_dictionary(ids = gRNAs, pod_size = 400) %>% mutate(precomp_file = factor(paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_precomp_", pod_id, ".fst")))
head(gRNA_dictionary)
write.fst(gRNA_dictionary, paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst"))
# 2. Gene precomputations
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_dictionary(ids = genes, pod_size = 212) %>% mutate(offset_file = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_offsets_", pod_id, ".fst") %>% factor(), dispersion_file = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_dispersion_", pod_id, ".fst"))
head(gene_dictionary)
gene_dictionary <- create_dictionary(ids = genes, pod_size = 212) %>% mutate(offset_file = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_offsets_", pod_id, ".fst") %>% factor(), dispersion_file = paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_dispersion_", pod_id, ".fst") %>% factor())
gene_dictionary$offset_file
gene_dictionary$dispersion_file
# 3. gRNA-gene pairs
pairs <- create_dictionary(ids = gRNA_gene_pairs$gRNA_group, pod_size = 2000, precomp_base_filename = paste0(offsite_dir, "/results/gasperini"))
# 3. gRNA-gene pairs
pairs <- create_dictionary(ids = gRNA_gene_pairs$gRNA_group, pod_size = 2000)
pairs
pairs <- rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id, file_name)
pairs <- rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id)
pairs
offsite_dir
pairs <- rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(offsite_dir, "/results/gasperini/result_file_", pod_id, ".fst"))
# 3. gRNA-gene pairs
pairs <- create_dictionary(ids = gRNA_gene_pairs$gRNA_group, pod_size = 2000)
head(pair)
head(pairs)
rename(pairs, gRNA_id = id)
rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id)
rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id)
rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(offsite_dir, "/results/gasperini/result_file_", pod_id, ".fst"))
pairs <- rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(offsite_dir, "/results/gasperini/result_file_", pod_id, ".fst"))
pairs$result_file[1]
pairs <- rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(offsite_dir, "/results/gasperini/result_", pod_id, ".fst"))
pairs <- rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(offsite_dir, "/results/gasperini/result_", pod_id, ".fst"))
pairs <- rename(pairs, gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(offsite_dir, "/results/gasperini/result_", pod_id, ".fst"))
# 3. gRNA-gene pairs
pairs <- create_dictionary(ids = gRNA_gene_pairs$gRNA_group, pod_size = 2000) %>% rename(gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(offsite_dir, "/results/gasperini/result_", pod_id, ".fst"))
pairs
head(pairs)
pairs$result_file[1]
write.fst(pairs, paste0(offsite_dir, "/results/gasperini/results_dictionary.fst"))
paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst")
# Create and store dictionary files
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
# Create and store dictionary files
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Create and store dictionary files
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA/gRNA_dictionary.fst")
gene_dictionary <- paste0(offsite_dir, "/data/gasperini/precomp/gene/gene_dictionary.fst")
offsite_dir
gRNA_gene_pairs
gRNA_precomp_dir
gene_dictionary
# Create and store dictionary files
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
head(gRNA_gene_pairs)
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA")
gene_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gene")
results_dir <- paste0(offsite_dir, "/results/gasperini")
gRNA_precomp_dir
gene_precomp_dir
results_dir
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA")
gene_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gene")
results_dir <- paste0(offsite_dir, "/results/gasperini")
gRNA_gene_pairs
# Create and store dictionary files
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
require(sceptre)
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA")
gene_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gene")
results_dir <- paste0(offsite_dir, "/results/gasperini")
gRNA_gene_pairs
gRNA_precomp_dir
gRNA_gene_pairs
gene_precomp_dir
gRNA_precomp_dir
results_dir
gRNA_precomp_dir
gRNA_precomp_dir
# 1. gRNA
gRNAs <- unique(gRNA_gene_pairs$gRNA_group)
head(gRNAs)
gRNA_dictionary <- create_dictionary(ids = gRNAs, pod_size = 400) %>% mutate(precomp_file = factor(paste0(gRNA_precomp_dir, "_", pod_id, ".fst")))
gRNA_dictionary
head(gRNA_dictionary)
gRNA_dictionary <- create_dictionary(ids = gRNAs, pod_size = 400) %>% mutate(precomp_file = factor(paste0(gRNA_precomp_dir, "/gRNA_precomp_", pod_id, ".fst")))
head(gRNA_dictionary)
head(gRNA_dictionary$precomp_file)
head(gRNA_gene_pairs)
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst")) %>% rename(gRNA_id = gRNA_group)
head(gRNA_gene_pairs)
# Create and store dictionary files
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst")) %>% rename(gRNA_id = gRNA_group)
head(gRNA_gene_pairs)
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA")
gene_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gene")
results_dir <- paste0(offsite_dir, "/results/gasperini")
pod_sizes <- c(gRNA = 400, 212, 2000)
pod_sizes <- c(gRNA = 400, gene = 212, pairs = 2000)
pod_sizes
head(gRNA_gene_pairs)
gene_precomp_dir
gRNA_precomp_dir
results_dir
pod_sizes
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst")) %>% rename(gRNA_id = gRNA_group)
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA")
gene_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gene")
results_dir <- paste0(offsite_dir, "/results/gasperini")
pod_sizes <- c(gRNA = 400, gene = 212, pairs = 2000)
# 1. gRNA
gRNAs <- unique(gRNA_gene_pairs$gRNA_id)
gRNA_dictionary <- create_dictionary(ids = gRNAs, pod_size = 400) %>% mutate(precomp_file = factor(paste0(gRNA_precomp_dir, "/gRNA_precomp_", pod_id, ".fst")))
head(gRNA_dictionary)
paste0(gRNA_precomp_dir, "/gRNA_dictionary.fst")
pod_sizes["gRNA"]
pod_sizes[["gRNA"]]
pod_sizes[["gene"]]
pod_sizes[["pairs"]]
# 2. genes
genes <- unique(gRNA_gene_pairs$gene_id)
genes
gene_precomp_dir
# 2. genes
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_dictionary(ids = genes, pod_size = pod_sizes[["gene"]]) %>% mutate(offset_file = paste0(gene_precomp_dir, "/gene_offsets_", pod_id, ".fst") %>% factor(), dispersion_file = paste0(gene_precomp_dir, "/gene_dispersion_", pod_id, ".fst") %>% factor())
gene_dictionary
gene_dictionary$offset_file[1]
gene_dictionary$offset_file[2]
gene_dictionary$dispersion_file[1]
# 1. gRNA
gRNAs <- unique(gRNA_gene_pairs$gRNA_id)
gRNA_dictionary <- create_dictionary(ids = gRNAs, pod_size = pod_sizes[["gRNA"]]) %>% mutate(precomp_file = factor(paste0(gRNA_precomp_dir, "/gRNA_precomp_", pod_id, ".fst")))
# 1. genes
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_dictionary(ids = genes, pod_size = pod_sizes[["gene"]]) %>% mutate(offset_file = paste0(gene_precomp_dir, "/gene_offsets_", pod_id, ".fst") %>% factor(), dispersion_file = paste0(gene_precomp_dir, "/gene_dispersion_", pod_id, ".fst") %>% factor())
gene_dictionary
gene_precomp_dir
gene_dictionary_fp <- paste0(gene_precomp_dir, "/gene_dictionary.fst")
gene_dictionary_fp
# 1. genes
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_dictionary(ids = genes, pod_size = pod_sizes[["gene"]]) %>% mutate(offset_file = paste0(gene_precomp_dir, "/gene_offsets_", pod_id, ".fst") %>% factor(), dispersion_file = paste0(gene_precomp_dir, "/gene_dispersion_", pod_id, ".fst") %>% factor())
gene_dictionary_fp <- paste0(gene_precomp_dir, "/gene_dictionary.fst")
write.fst(gene_dictionary, gene_dictionary_fp)
gene_dictionary_fp
head(gene_dictionary)
gene_dictionary_fp
# 2. gRNA
gRNAs <- unique(gRNA_gene_pairs$gRNA_id)
gRNAs
gRNA_dictionary <- create_dictionary(ids = gRNAs, pod_size = pod_sizes[["gRNA"]]) %>% mutate(precomp_file = factor(paste0(gRNA_precomp_dir, "/gRNA_precomp_", pod_id, ".fst")))
head(gRNA_dictionary)
gRNA_dictionary$precomp_file
gRNA_dictionary$precomp_file[1]
gRNA_dictionary_fp <- paste0(gRNA_precomp_dir, "/gRNA_dictionary.fst")
gRNA_dictionary_fp
write.fst(gRNA_dictionary, gRNA_dictionary_fp)
create_dictionary(ids = gRNA_gene_pairs$gRNA_id, pod_size = pod_sizes[["pairs"]]) %>% rename(gRNA_id = id)
create_dictionary(ids = gRNA_gene_pairs$gRNA_id, pod_size = pod_sizes[["pairs"]]) %>% rename(gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id)
results_dir
# 3. gRNA-gene pairs
pairs <- create_dictionary(ids = gRNA_gene_pairs$gRNA_id, pod_size = pod_sizes[["pairs"]]) %>% rename(gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(results_dir, "/result_", pod_id, ".fst"))
head(pairs)
pairs$result_file[1]
results_dir
paste0(results_dir, "/results_dictionary.fst")
pairs_dictionary <- paste0(results_dir, "/results_dictionary.fst")
write.fst(pairs, pairs_dictionary)
pairs_dictionary_fp <- paste0(results_dir, "/results_dictionary.fst")
c(gene_dictionary_fp = gene_dictionary_fp, gRNA_dictionary_fp = gRNA_dictionary_fp, pairs_dictionary_fp = pairs_dictionary_fp)
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
head(gRNA_gene_pairs)
"/Volumes/tims_new_drive/research/sceptre_files/results/gasperini"
pod_sizes <- c(gene = 200, gRNA = 1000, pair = 12000)
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
gene_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gene")
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA")
results_dir <- paste0(offsite_dir, "/Volumes/tims_new_drive/research/sceptre_files/results/gasperini")
pod_sizes <- c(gene = 200, gRNA = 1000, pair = 12000)
library(sceptre)
library(sceptre)
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
gene_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gene")
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA")
results_dir <- paste0(offsite_dir, "/Volumes/tims_new_drive/research/sceptre_files/results/gasperini")
pod_sizes <- c(gene = 200, gRNA = 1000, pair = 12000)
create_and_store_dictionaries(gRNA_gene_pairs, gene_precomp_dir, gRNA_precomp_dir, results_dir, pod_sizes)
gRNA_gene_pairs; gene_precomp_dir; gRNA_precomp_dir; results_dir; pod_sizes
# 1. genes
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_dictionary(ids = genes, pod_size = pod_sizes[["gene"]]) %>% mutate(offset_file = paste0(gene_precomp_dir, "/gene_offsets_", pod_id, ".fst") %>% factor(), dispersion_file = paste0(gene_precomp_dir, "/gene_dispersion_", pod_id, ".fst") %>% factor())
gene_dictionary_fp <- paste0(gene_precomp_dir, "/gene_dictionary.fst")
write.fst(gene_dictionary, gene_dictionary_fp)
# 2. gRNA
gRNAs <- unique(gRNA_gene_pairs$gRNA_id)
gRNA_dictionary <- create_dictionary(ids = gRNAs, pod_size = pod_sizes[["gRNA"]]) %>% mutate(precomp_file = factor(paste0(gRNA_precomp_dir, "/gRNA_precomp_", pod_id, ".fst")))
# 2. gRNA
gRNAs <- unique(gRNA_gene_pairs$gRNA_id)
gRNAs
# 2. gRNA
gRNAs <- unique(gRNA_gene_pairs$gRNA_id)
head(gRNA_gene_pairs)
# 4. Extract the target_site-gRNA pairs to analyze.
all_deg_results <- suppressWarnings(read_tsv(paste0(raw_data_dir, "/GSE120861_all_deg_results.at_scale.txt"), col_types = "cddddddccccciiciiccl"))
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
processed_dir <- paste0(offsite_dir, "/data/gasperini/processed")
raw_data_dir <-  paste0(offsite_dir, "/data/gasperini/raw")
# 4. Extract the target_site-gRNA pairs to analyze.
all_deg_results <- suppressWarnings(read_tsv(paste0(raw_data_dir, "/GSE120861_all_deg_results.at_scale.txt"), col_types = "cddddddccccciiciiccl"))
pairs_to_analyze <- all_deg_results %>% rename(gene_id = ENSG) %>% select(gene_id, gRNA_group) %>% arrange()
head(pairs_to_analyze)
pairs_to_analyze <- all_deg_results %>% rename(gene_id = ENSG, gRNA_id = gRNA_group) %>% select(gene_id, gRNA_id) %>% arrange()
pairs_to_analyze
write.fst(pairs_to_analyze, paste0(processed_dir, "/gene_gRNA_pairs_to_study.fst"))
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(offsite_dir, "/data/gasperini/processed/gene_gRNA_pairs_to_study.fst"))
gene_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gene")
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA")
results_dir <- paste0(offsite_dir, "/Volumes/tims_new_drive/research/sceptre_files/results/gasperini")
pod_sizes <- c(gene = 200, gRNA = 1000, pair = 12000)
create_and_store_dictionaries(gRNA_gene_pairs, gene_precomp_dir, gRNA_precomp_dir, results_dir, pod_sizes)
gRNA_gene_pairs; gene_precomp_dir; gRNA_precomp_dir; results_dir; pod_sizes
# 1. genes
genes <- unique(gRNA_gene_pairs$gene_id)
gene_dictionary <- create_dictionary(ids = genes, pod_size = pod_sizes[["gene"]]) %>% mutate(offset_file = paste0(gene_precomp_dir, "/gene_offsets_", pod_id, ".fst") %>% factor(), dispersion_file = paste0(gene_precomp_dir, "/gene_dispersion_", pod_id, ".fst") %>% factor())
gene_dictionary_fp <- paste0(gene_precomp_dir, "/gene_dictionary.fst")
write.fst(gene_dictionary, gene_dictionary_fp)
# 2. gRNA
gRNAs <- unique(gRNA_gene_pairs$gRNA_id)
gRNA_dictionary <- create_dictionary(ids = gRNAs, pod_size = pod_sizes[["gRNA"]]) %>% mutate(precomp_file = factor(paste0(gRNA_precomp_dir, "/gRNA_precomp_", pod_id, ".fst")))
gRNA_dictionary_fp <- paste0(gRNA_precomp_dir, "/gRNA_dictionary.fst")
write.fst(gRNA_dictionary, gRNA_dictionary_fp)
# 3. gRNA-gene pairs
pairs <- create_dictionary(ids = gRNA_gene_pairs$gRNA_id, pod_size = pod_sizes[["pair"]]) %>% rename(gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(results_dir, "/result_", pod_id, ".fst"))
pairs_dictionary_fp <- paste0(results_dir, "/results_dictionary.fst")
write.fst(pairs, pairs_dictionary_fp)
# 3. gRNA-gene pairs
pairs <- create_dictionary(ids = gRNA_gene_pairs$gRNA_id, pod_size = pod_sizes[["pair"]]) %>% rename(gRNA_id = id) %>% mutate(gene_id = gRNA_gene_pairs$gene_id) %>% select(gRNA_id, gene_id, pod_id) %>% mutate(result_file = paste0(results_dir, "/result_", pod_id, ".fst"))
pairs_dictionary_fp <- paste0(results_dir, "/results_dictionary.fst")
pairs_dictionary_fp <- paste0(results_dir, "/results_dictionary.fst")
results_dir
paste0(offsite_dir, "results/gasperini")
results_dir <- paste0(offsite_dir, "/results/gasperini")
results_dir
pod_sizes <- c(gene = 200, gRNA = 1000, pair = 12000)
create_and_store_dictionaries(gRNA_gene_pairs, gene_precomp_dir, gRNA_precomp_dir, results_dir, pod_sizes)
dicts <- create_and_store_dictionaries(gRNA_gene_pairs, gene_precomp_dir, gRNA_precomp_dir, results_dir, pod_sizes)
dicts[1]
code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
source(paste0(code_dir, "analysis_drivers/file_paths_to_dirs"))
source(paste0(code_dir, "/analysis_drivers/file_paths_to_dirs"))
code_dir
source(paste0(code_dir, "/analysis_drivers/file_paths_to_dirs.R"))
"/Volumes/tims_new_drive/research/sceptre_files"
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
paste0(code_dir, "/analysis_drivers/file_paths_to_dirs.R")
source(paste0(code_dir, "/analysis_drivers/file_paths_to_dirs.R"))
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(precomp_dir_gene, "/gene_gRNA_pairs_to_study.fst"))
processed_dir
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(oprocessed_dir, "/gene_gRNA_pairs_to_study.fst"))
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(processed_dir, "/gene_gRNA_pairs_to_study.fst"))
gene_precomp_dir <- precomp_dir_gene
gRNA_precomp_dir <- precomp_dir_gRNA
results_dir <- paste0(offsite_dir, "/results")
results_dir
results_dir <- paste0(offsite_dir, "/results/gasperini")
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
source(paste0(code_dir, "/analysis_drivers/file_paths_to_dirs.R"))
args <- commandArgs(trailingOnly = TRUE)
offsite_dir <- args[1] # offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
code_dir <- args[2] # code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
offsite_dir
code_dir
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
source(paste0(code_dir, "/analysis_drivers/file_paths_to_dirs.R"))
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(processed_dir, "/gene_gRNA_pairs_to_study.fst"))
dicts <- create_and_store_dictionaries(gRNA_gene_pairs = gRNA_gene_pairs, gene_precomp_dir = gene_precomp_dir, gRNA_precomp_dir = gRNA_precomp_dir, results_dir = results_dir, pod_sizes = c(gene = 200, gRNA = 1000, pair = 12000))
gRNA_gene_pairs
gene_precomp_dir
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
source(paste0(code_dir, "/analysis_drivers/file_paths_to_dirs.R"))
# Load the gRNAs and genes to analyze
gRNA_gene_pairs <- read.fst(paste0(processed_dir, "/gene_gRNA_pairs_to_study.fst"))
dicts <- create_and_store_dictionaries(gRNA_gene_pairs = gRNA_gene_pairs, gene_precomp_dir = gene_precomp_dir, gRNA_precomp_dir = gRNA_precomp_dir, results_dir = results_dir, pod_sizes = c(gene = 200, gRNA = 1000, pair = 12000))
offsite_directory <- "/Volumes/tims_new_drive/research/sceptre_files"
args <- commandArgs(trailingOnly = TRUE)
offsite_dir <- args[1] # offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
code_dir <- args[2] # code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
paste0(offsite_dir, "/data/gasperini/processed")
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
source(paste0(code_dir, "/analysis_drivers/file_paths_to_dirs.R"))
paste0(offsite_dir, "/data/gasperini/processed")
processed_dir
paste0(offsite_dir, "/data/gasperini/raw")
raw_data_dir
offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
paste0(code_dir, "/analysis_drivers/file_paths_to_dirs.R")
source(paste0(code_dir, "/analysis_drivers/file_paths_to_dirs.R"))
paste0(offsite_dir, "/data/gasperini/processed")
paste0(offsite_dir, "/data/gasperini/raw")
processed_dir
raw_data_dir
raw_data_dir
args <- commandArgs(trailingOnly = TRUE)
args
args[1]
args[2]
# directory file paths
args <- commandArgs(trailingOnly = TRUE)
offsite_dir <- args[1]
code_dir <- args[2]
# If there is no command line argument, I am running this script on my laptop.
if (is.na(offsite_dir)) offsite_dir <- "/Volumes/tims_new_drive/research/sceptre_files"
if (is.na(code_dir)) code_dir <- "/Users/timbarry/Box/SCEPTRE/sceptre_paper/"
offsite_dir
code_dir
processed_dir <- paste0(offsite_dir, "/data/gasperini/processed")
gene_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gene")
gRNA_precomp_dir <- paste0(offsite_dir, "/data/gasperini/precomp/gRNA")
results_dir <- paste0(offsite_dir, "/results/gasperini")
raw_data_dir <- paste0(offsite_dir, "/data/gasperini/raw")
processed_dir
gene_precomp_dir
gRNA_precomp_dir
results_dir
raw_data_dir
